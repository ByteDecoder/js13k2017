<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>GREEBLE</title><style>
body{margin:0;overflow:hidden;background:#111;color:#ccc}#canvas{position:fixed;top:50%;bottom:0;left:50%;right:0;width:144vmin;height:96vmin;transform:translate(-50%,-25%);image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor;cursor:none;margin:auto}
</style></head><body><canvas id="canvas"></canvas><script>
!function(){function e(e){ue.fill(e,oe,oe+Y)}function n(e,t,n){e=(0|e).clamp(0,j-1),t=(0|t).clamp(0,U-1),n|=0,ue[oe+t*j+e]=n}function a(e,t,n=oe){return ue[n+e+t*j]}function o(e,t,a,o,r){var s,i,l=o-t,p=a-e;if(l<0?(l=-l,i=-1):i=1,p<0?(p=-p,s=-1):s=1,l<<=1,p<<=1,n(e,t,r),p>l)for(var y=l-(p>>1);e!=a;)y>=0&&(t+=i,y-=p),y+=l,n(e+=s,t,r);else for(y=p-(l>>1);t!=o;)y>=0&&(e+=s,y-=l),y+=p,n(e,t+=i,r)}function r(e,t,a,o){var r=-a,s=0,i=2-2*a;do{n(e-r,t+s,o),n(e-s,t-r,o),n(e+r,t-s,o),n(e+s,t+r,o),(a=i)<=s&&(i+=2*++s+1),(a>r||i>s)&&(i+=2*++r+1)}while(r<0)}function s(e,t,n,a){if(!(n<0)){e|=0,t|=0,a|=0;var r=-(n|=0),s=0,i=2-2*n;do{o(e-r,t-s,e+r,t-s,a),o(e-r,t+s,e+r,t+s,a),(n=i)<=s&&(i+=2*++s+1),(n>r||i>s)&&(i+=2*++r+1)}while(r<0)}}function i(e,t,n,a,r){x1=0|e,y1=0|t,x2=e+n|0,y2=t+a|0,o(x1,y1,x2,y1,r),o(x2,y1,x2,y2,r),o(x1,y2,x2,y2,r),o(x1,y1,x1,y2,r)}function l(e,t,n,a,r){x1=0|e,y1=0|t,x2=e+n|0,y2=t+a|0;var s=Math.abs(y2-y1);if(o(x1,y1,x2,y1,r),s>0)for(;--s;)o(x1,y1+s,x2,y1+s,r);o(x1,y2,x2,y2,r)}function p(e,t,n,a,o,r){for(let s=0;s<=o;s++)l(e+s,t-s,n-2*s,a+2*s,r)}function y(e,t,n,a,r,s){let i=e+r,l=e+n-r,p=e+n,y=t+r,f=t+a-r,u=t+a;o(i,t,l,t,s),o(l,t,p,y,s),o(p,y,p,f,s),o(p,f,l,u,s),o(l,u,i,u,s),o(i,u,e,f,s),o(e,f,e,y,s),o(e,y,i,t,s)}function f(e,t,n,a=n,o=n,r=n){for(let s=0;s<j;s++)for(let i=0;i<U;i++){let l=s-1+i*j,p=s+1+i*j,y=s+(i+1)*j,f=s+(i-1)*j;ue[e+(s+i*j)]&&(ue[e+l]||(ue[t+l]=n),ue[e+p]||(ue[t+p]=o),ue[e+f]||(ue[t+f]=a),ue[e+y]||(ue[t+y]=r))}}function u(e,t,n,a,o,r,s){var i=j,e=Math.round(16*e),n=Math.round(16*n),o=Math.round(16*o),t=Math.round(16*t),l=e-n,p=(a=Math.round(16*a))-t,y=n-o,f=(r=Math.round(16*r))-a,u=o-e,c=t-r,d=Math.max(Math.min(e,n,o)+15>>4,0),h=Math.min(Math.max(e,n,o)+15>>4,j),m=Math.max(Math.min(t,a,r)+15>>4,0),x=Math.min(Math.max(t,a,r)+15>>4,U);d&=-8,m&=-8;var g=-p*e-l*t,_=-f*n-y*a,v=-c*o-u*r;(p>0||0==p&&l>0)&&g++,(f>0||0==f&&y>0)&&_++,(c>0||0==c&&u>0)&&v++,g=g-1>>4,_=_-1>>4,v=v-1>>4;var w=0,R=0,M=0,I=0,K=0,S=0;l>=0?R-=7*l:w-=7*l,p>=0?R-=7*p:w-=7*p,y>=0?I-=7*y:M-=7*y,f>=0?I-=7*f:M-=7*f,u>=0?S-=7*u:K-=7*u,c>=0?S-=7*c:K-=7*c;for(var D=i-8,b=m;b<x;b+=8)for(var G=d;G<h;G+=8){var N=g+l*b+p*G,T=_+y*b+f*G,E=v+u*b+c*G;if(!(N<R||T<I||E<S)){var L=G+b*i;if(N>=w&&T>=M&&E>=K)for(A=0;A<8;A++){for(O=0;O<8;O++,L++)ue[oe+L]=s;L+=D}else for(var A=0;A<8;A++){for(var C=N,F=T,k=E,O=0;O<8;O++)(C|F|k)>=0&&(ue[oe+L]=s),C+=p,F+=f,k+=c,L++;N+=l,T+=y,E+=u,L+=D}}}}function c(e=0,t=0,n=384,a=256,o=0,r=0,s=!1,i=!1){for(var l=0;l<a;l++)for(var p=0;p<n;p++)r+l<U&&o+p<j&&r+l>-1&&o+p>-1&&(s&i?ue[re+((t+(a-l))*j+e+(n-p))]>0&&(ue[oe+((r+l)*j+o+p)]=ie[ue[re+((t+(a-l))*j+e+(n-p))]]):i&&!s?ue[re+((t+(a-l))*j+e+p)]>0&&(ue[oe+((r+l)*j+o+p)]=ue[re+((t+(a-l))*j+e+p)]):s&&!i?ue[re+((t+l)*j+e+(n-p))]>0&&(ue[oe+((r+l)*j+o+p)]=ue[re+((t+l)*j+e+(n-p))]):s||i||ue[re+((t+l)*j+e+p)]>0&&(ue[oe+((r+l)*j+o+p)]=ie[ue[re+((t+l)*j+e+p)]]))}function d(e,t,n,a,o,r,s,i){i*=.0174533;let l=n/2|0,p=a/2|0,y=n*s/2*1.41421356237|5,f=a*s/2*1.41421356237|5,u=-y,c=y,d=-f,h=f,m=1/s,x=Math.cos(-i)*m,g=Math.sin(-i)*m;for(let s=d;s<h;s++)for(let i=u;i<c;i++){let y=l+Math.round(x*i+g*s),f=p+Math.round(-g*i+x*s),u=i+o|0,c=s+r|0;y>=0&&f>=0&&y<n&&f<a&&ue[re+(y+e)+(f+t)*j]>0&&(u.clamp(0,j),c.clamp(0,U),ue[oe+u+c*j]=ue[re+(y+e)+(f+t)*j])}}function h(e,t=1,n=0,a=!1,o=1){var r=we.createBufferSource(),s=we.createGain(),i=we.createStereoPanner();return r.buffer=e,r.connect(i),i.connect(s),s.connect(we.destination),r.playbackRate.value=t,r.loop=a,s.gain.value=o,i.pan.value=n.clamp(-1,1),r.start(),{volume:s,sound:r}}function m(){for(var e=Y;e--;)fe[e]=se[ie[ue[e]]];le.data.set(ye),ae.putImageData(le,0,0)}function x(){e(0),oe=J,re=J,l(8,10,17,9,8),l(7,11,19,7,8),l(9,12,15,5,2),l(11,14,2,1,16),l(21,14,2,1,16),o(12,15,13,15,21),o(22,15,23,15,21),o(17,9,17,6,5),n(17,6,21),l(44,15,3,1,5),l(42,17,7,7,5),l(43,21,5,5,0),s(139,28,5,13),l(74,22,2,5,8),s(75,28,3,8),r(75,28,1,5),u(105,19,114,27,117,23,8),l(206,10,4,12,9),f(J,H,23,21,31,23),re=H,c(),re=J,c(128,0,32,40,165,4),c(32,0,32,32,162,5),c(64,0,32,32,165,4),c(96,0,32,32,165,3),c(0,0,32,32,160,0),c(32,0,32,32,162,45),c(0,0,32,32,160,40),c(32,0,32,32,162,85),c(96,0,32,32,165,83),c(0,0,32,32,160,80)}function g(e=Date.now(),t=1664525,n=1013904223,a=Math.pow(2,32)){this.seed=e,this.a=t,this.c=n,this.m=a}function _(e){return Math.sin(6.283184*e)}function v(e){return.00390625*Math.pow(1.059463094,e-128)}function w(e,t){setTimeout(function(){var n=new Uint8Array(e*_e*2),a=n.length-2,o=function(){for(var e=new Date,r=0;a>=0;)if(n[a]=0,n[a+1]=128,a-=2,(r+=1)%1e3==0&&new Date-e>ve)return void setTimeout(o,0);setTimeout(function(){t(n)},0)};setTimeout(o,0)},0)}function R(e,t,n,a,o){var r=n.fx_delay_time*a>>1,s=n.fx_delay_amt/255,i=0,l=function(){for(var n=new Date,a=0;i<t-r;){var p=4*i,y=4*(i+r),f=e[y]+(e[y+1]<<8)+(e[p+2]+(e[p+3]<<8)-32768)*s;if(e[y]=255&f,e[y+1]=f>>8&255,f=e[y+2]+(e[y+3]<<8)+(e[p]+(e[p+1]<<8)-32768)*s,e[y+2]=255&f,e[y+3]=f>>8&255,++i,(a+=1)%1e3==0&&new Date-n>ve)return void setTimeout(l,0)}setTimeout(o,0)};setTimeout(l,0)}function M(e){lcg.setSeed(1019);let t=Y*P;for(;--t;)ue[t]=0;switch(x(),e){case Me:currentRoom[0]--,currentRoom[0]<0&&(currentRoom[0]=Oe),console.log(currentRoom);break;case Ie:currentRoom[0]++,currentRoom[0]>Oe&&(currentRoom[0]=0),console.log(currentRoom);break;case Ke:currentRoom[1]--,currentRoom[1]<0&&(currentRoom[1]=qe),console.log(currentRoom);break;case Se:currentRoom[1]++,currentRoom[1]>qe&&(currentRoom[1]=0),console.log(currentRoom)}oe=V,rooms[world[currentRoom[1]*(Oe+1)+currentRoom[0]]].draw(),I()}function I(){lcg.setSeed(1019+currentRoom[0]+1234.5678*currentRoom[1]),oe=ee,e(0),oe=Z,e(0),oe=$,e(0),K(),N(),T(),D(),D(),G(),b(),oe=V,rooms[world[currentRoom[1]*(Oe+1)+currentRoom[0]]].specials()}function K(){oe=ee,e(0);let t=5e3;for(;--t;)n(lcg.nextIntRange(0,384),lcg.nextIntRange(0,256),1);for(t=200;--t;)n(lcg.nextIntRange(0,384),lcg.nextIntRange(0,256),26);for(t=60;--t;)n(lcg.nextIntRange(0,384),lcg.nextIntRange(0,256),20);for(t=20;--t;)n(lcg.nextIntRange(0,384),lcg.nextIntRange(0,256),21);for(t=3;--t;)s(lcg.nextIntRange(0,384),lcg.nextIntRange(0,256),lcg.nextIntRange(2,5),lcg.nextIntRange(16,19))}function S(){let e=Y;for(;--e;){let n=ue[V+e],a=e/j|0,o=e%j;switch(re=J,oe=X,n){case Ee:d(192,0,32,32,o-2,a-5,1,90*t);break;case Ce:d(32,0,32,32,o-2,a-5,1,90*t);break;case Fe:case ke:d(96,0,32,32,o-2,a-5,1,90*t)}}}function D(t=1,n=1,o=15,r=3,s=1){re=V,oe=W,e(0);for(i=3e3;--i;){let e=lcg.nextIntRange(0,j),t=lcg.nextIntRange(0,U);a(e,t,V)==Te&&(roomNG.setSeed(lcg.seed+e+1234.5678*t),l(e+roomNG.nextIntRange(-2,2),t+roomNG.nextIntRange(-2,2),roomNG.nextIntRange(2,6),1,2))}oe=Q,e(0),f(W,Q,1),oe=Z,re=W,c(),re=Q,c();for(var i=3e3;--i;){let e=lcg.nextIntRange(0,j),t=lcg.nextIntRange(0,U);a(e,t,V)==Te&&(roomNG.setSeed(lcg.seed+e+1234.5678*t),l(e+roomNG.nextIntRange(-2,2),t+roomNG.nextIntRange(-2,2),1,roomNG.nextIntRange(2,6),2))}oe=Q,e(0),f(W,Q,1,15,3,1),oe=Z,re=W,c(),re=Q,c()}function b(t=1,n=2,a=15,o=2,s=0){oe=W,e(0);for(var i=400;--i;){let e=lcg.nextIntRange(0,j),n=lcg.nextIntRange(0,U);ue[V+e+n*j]==Te&&(roomNG.setSeed(lcg.seed+e+1234.5678*n),l(e+roomNG.nextIntRange(-5,0),n+roomNG.nextIntRange(-20,0),t,roomNG.nextIntRange(1,16),1),r(e,n-10,1,t))}oe=Q,e(0),f(W,Q,n,a,o,s),oe=$,re=W,c(),re=Q,c()}function G(){oe=W,e(0);for(var t=1500;--t;){let e=lcg.nextIntRange(0,j),t=lcg.nextIntRange(0,U);ue[V+e+t*j]==Te&&(roomNG.setSeed(lcg.seed+e+1234.5678*t),p(e,t,roomNG.nextIntRange(5,13),roomNG.nextIntRange(2,4),1,25))}let n=2e3;for(;--n;){let e=lcg.nextIntRange(0,j),t=lcg.nextIntRange(0,U);ue[V+e+t*j]==Te&&(roomNG.setSeed(lcg.seed+e+1234.5678*t),l(e,t,roomNG.nextIntRange(3,7),roomNG.nextIntRange(1,3),0))}for(n=15;--n;){let e=lcg.nextIntRange(0,j),t=lcg.nextIntRange(0,U);ue[V+e+t*j]==Te&&(roomNG.setSeed(lcg.seed+e+1234.5678*t),l(e,t,roomNG.nextIntRange(10,80),roomNG.nextIntRange(10,80),0))}oe=Q,e(0),f(W,Q,24,18,25),oe=Z,re=W,c(),re=Q,c()}function N(){let e=Y;for(;--e;)ue[V+e]==Ae&&(roomNG.setSeed(lcg.seed+1234.5678*e),ue[Z+e]=roomNG.nextIntRange(2,4))}function T(){let e=Y;for(;--e;)ue[V+e]==Le&&(roomNG.setSeed(lcg.seed+1234.5678*e),ue[Z+e]=roomNG.nextIntRange(9,11))}function E(e,t,n,a,o){oe=Z,re=J;let r=o;for(;r--;)ie=paldrk,roomNG.setSeed(lcg.seed+1234.5678*r),d(0,0,32,32,roomNG.nextIntRange(e,e+n),roomNG.nextIntRange(t,t+a),1,roomNG.nextIntRange(0,359)),ie=te}function L(){let e=36;for(;e--;){roomNG.setSeed(lcg.seed+1234.5678*e);let n=(roomNG.nextIntRange(-200,U)-20*t|0)%U*2+U,a=roomNG.nextIntRange(20,120),o=roomNG.nextIntRange(10,30);y(roomNG.nextIntRange(-200,j),n,a,o,5,1)}}function A(){let e=150;for(;e--;){oe=ee,roomNG.setSeed(lcg.seed+1234.5678*e);let t=roomNG.nextIntRange(60,U),n=roomNG.nextIntRange(3,15);s(roomNG.nextIntRange(0,j),t,n,1)}for(e=150;e--;){oe=ee,roomNG.setSeed(lcg.seed+1232.5678*e);let t=roomNG.nextIntRange(100,U),n=roomNG.nextIntRange(3,15);s(roomNG.nextIntRange(0,j),t,n,14)}for(e=100;e--;){oe=ee,roomNG.setSeed(lcg.seed+1230.5678*e);let t=roomNG.nextIntRange(150,U),n=roomNG.nextIntRange(15,20);s(roomNG.nextIntRange(0,j),t,n,14)}}function C(){let e=150;for(;e--;){oe=ee,roomNG.setSeed(lcg.seed+1234.5678*e);let t=roomNG.nextIntRange(0,U),n=roomNG.nextIntRange(15,60),a=roomNG.nextIntRange(15,60);y(roomNG.nextIntRange(0,j),t,n,a,3,1)}}function F(e){e.forEach(function(e,t,a){1==e&&l(t%12*32,32*(t/12|0),32,32,Te),2==e&&n(t%12*32+16,32*(t/12|0)+16,Ee)})}function k(e=0,t=0,n=10,a=10,o=21,r=!1,s=!1){this.x=e,this.y=t,this.maxSize=n,this.speed=a,this.counter=this.speed,this.color=o,this.size=1,this.filled=r,this.square=s}function O(e="",t=9,n=200){this.text=e,this.color=t,this.time=n,this.string="",this.counter=0}function q(e){for(var t=e[0].length,a=0;a<t;a++){var o=[];o=z(e[0].charAt(a));for(var r=0;r<5;r++)for(var s=0;s<5;s++)1==o[5*r+s]&&(1==e[4]?n(e[1]+s*e[4]+(5*e[4]+e[3])*a,e[2]+r*e[4],e[5]):l(e[1]+s*e[4]+(5*e[4]+e[3])*a,e[2]+r*e[4],e[4],e[4],e[5]))}}function B(e){var t=5*e[7],n=e[0].split("\n"),a=n.slice(0),o=n.length,r=a.sort(function(e,t){return t.length-e.length})[0],s=r.length*t+(r.length-1)*e[3],i=o*t+(o-1)*e[4];e[5]||(e[5]="left"),e[6]||(e[6]="bottom");var l=e[1],p=e[2],y=e[1]+s,f=e[2]+i;"center"==e[5]?(l=e[1]-s/2,y=e[1]+s/2):"right"==e[5]&&(l=e[1]-s,y=e[1]),"center"==e[6]?(p=e[2]-i/2,f=e[2]+i/2):"bottom"==e[6]&&(p=e[2]-i,f=e[2]);for(var u=l+s/2,c=p+i/2,d=0;d<o;d++){var h=n[d],m=h.length*t+(h.length-1)*e[3],x=e[1],g=e[2]+(t+e[4])*d;"center"==e[5]?x=e[1]-m/2:"right"==e[5]&&(x=e[1]-m),"center"==e[6]?g-=i/2:"bottom"==e[6]&&(g-=i),q([h,x,g,e[3]||0,e[7]||1,e[8],e[9]])}return{sx:l,sy:p,cx:u,cy:c,ex:y,ey:f,width:s,height:i}}function z(e){return index=fontString.indexOf(e),fontBitmap.substring(25*index,25*index+25).split("")}const j=383,U=255,P=11,Y=j*U,X=0,H=Y,W=3*Y,Q=4*Y,J=10*Y,V=6*Y,Z=7*Y,$=8*Y,ee=9*Y,te=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31];var ne=document.getElementById("canvas"),ae=ne.getContext("2d"),oe=0,re=Y,se=[4278190080,4281606178,4282132549,4281416038,4282078863,4280709599,4284915929,4288332782,4281791227,4283491737,4281384554,4285436983,4281297227,4280568658,4281941042,4285808447,4286734384,4292963931,4294941539,4293184863,4294761419,4294967295,4290227611,4287069828,4285164137,4283586137,4287251062,4281479852,4284700633,4290411479,4283078543,4281364362],ie=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31];paldrk=[0,0,1,2,3,4,5,6,6,10,11,12,13,14,2,2,15,16,17,18,22,20,23,24,25,26,2,2,27,28,31,13],ae.imageSmoothingEnabled=!1,ae.mozImageSmoothingEnabled=!1,ne.width=j,ne.height=U;var le=ae.getImageData(0,0,j,U),pe=new ArrayBuffer(le.data.length),ye=new Uint8Array(pe),fe=new Uint32Array(pe),ue=new Uint8ClampedArray(j*U*P);Number.prototype.clamp=function(e,t){return Math.min(Math.max(this,e),t)},Number.prototype.map=function(e,t,n,a){return(this-e)/(t-e)*(a-n)+n},world=[3,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,2,2,4,2,2,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,7,7,7,7,7,7,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,5,0,7,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,5,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var ce={osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:117,osc1_waveform:3,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:155,osc2_waveform:2,noise_fader:0,env_attack:7105,env_sustain:0,env_release:444,env_master:192,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:2,fx_delay_amt:16,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:59,lfo_waveform:0},de={rowLen:2544,endPattern:2,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:192,osc1_waveform:3,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:166,osc2_waveform:3,noise_fader:47,env_attack:0,env_sustain:1234,env_release:19736,env_master:72,fx_filter:2,fx_freq:5029,fx_resonance:132,fx_delay_time:4,fx_delay_amt:16,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1],c:[{n:[171,170,171,170,171,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:4},he={rowLen:4134,endPattern:2,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:2,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:192,osc2_waveform:2,noise_fader:0,env_attack:0,env_sustain:351,env_release:5268,env_master:103,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:3,fx_delay_amt:56,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1],c:[{n:[161,166,170,175,173,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:7},me={osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:255,osc1_waveform:0,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:255,osc2_waveform:0,noise_fader:163,env_attack:50,env_sustain:150,env_release:96977,env_master:228,fx_filter:2,fx_freq:1934,fx_resonance:254,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0},xe={osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:82,osc1_waveform:2,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:255,env_attack:100,env_sustain:0,env_release:663,env_master:186,fx_filter:2,fx_freq:5200,fx_resonance:63,fx_delay_time:1,fx_delay_amt:25,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0};fontString="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_!@#.'\"?/<()",fontBitmap="11111100011111110001100011111010001111101000111110111111000010000100000111111100100101000110001111101111110000111001000011111111111000011100100001000011111100001011110001111111000110001111111000110001111110010000100001001111111111000100001010010111101000110010111001001010001100001000010000100001111110001110111010110001100011000111001101011001110001011101000110001100010111011110100011001011100100000111010001100011001001111111101000111110100011000101111100000111000001111101111100100001000010000100100011000110001100010111010001100011000101010001001000110001101011010101110100010101000100010101000110001010100010000100001001111100010001000100011111001000110000100001000111001110100010001000100111111111000001001100000111110100101001011111000100001011111100001111000001111100111110000111101000101110111110000100010001000010001110100010111010001011100111010001011110000101110011101000110001100010111000000000000000000000111110010000100001000000000100111111000110111101011011101010111110101011111010100000000000000000000000100001100001000100000000000011011010011001000000000000111010001001100000000100000010001000100010001000000010001000100000100000100001000100001000010000010",g.prototype.setSeed=function(e){this.seed=e},g.prototype.nextInt=function(){return this.seed=(this.seed*this.a+this.c)%this.m,this.seed},g.prototype.nextFloat=function(){return this.nextInt()/this.m},g.prototype.nextBool=function(e){return null==e&&(e=.5),this.nextFloat()<e},g.prototype.nextFloatRange=function(e,t){return e+this.nextFloat()*(t-e)},g.prototype.nextIntRange=function(e,t){return Math.floor(this.nextFloatRange(e,t))},g.prototype.nextColor=function(){for(var e=this.nextIntRange(0,Math.pow(2,24)).toString(16).toUpperCase();e.length<6;)e="0"+e;return"#"+e};var ge={},_e=2,ve=33,we=null,Re=[_,function(e){return _(e)<0?-1:1},function(e){return e%1-.5},function(e){var t=e%1*4;return t<2?t-1:3-t}];ge.AudioGenerator=function(e){this.mixBuf=e,this.waveSize=e.length/_e/2},ge.AudioGenerator.prototype.getAudioBuffer=function(e){null===we&&(we=new AudioContext);var t=this.mixBuf,n=this.waveSize*_e*2,a=we.createBuffer(_e,this.waveSize,44100),o=a.getChannelData(0),r=a.getChannelData(1),s=0,i=function(){for(var l=new Date,p=0;s<n/2;){var y=4*(t[4*s]+(t[4*s+1]<<8)-32768);if(y=y<-32768?-32768:y>32767?32767:y,o[s]=y/32768,y=4*(t[4*s+2]+(t[4*s+3]<<8)-32768),y=y<-32768?-32768:y>32767?32767:y,r[s]=y/32768,s+=1,(p+=1)%1e3==0&&new Date-l>ve)return void setTimeout(i,0)}setTimeout(function(){e(a)},0)};setTimeout(i,0)},ge.SoundGenerator=function(e,t){this.instr=e,this.rowLen=t||5605,this.osc_lfo=Re[e.lfo_waveform],this.osc1=Re[e.osc1_waveform],this.osc2=Re[e.osc2_waveform],this.attack=e.env_attack,this.sustain=e.env_sustain,this.release=e.env_release,this.panFreq=Math.pow(2,e.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,e.lfo_freq-8)/this.rowLen},ge.SoundGenerator.prototype.genSound=function(e,t,n){new Date;for(var a=0,o=0,r=v(e+12*(this.instr.osc1_oct-8)+this.instr.osc1_det)*(1+8e-4*this.instr.osc1_detune),s=v(e+12*(this.instr.osc2_oct-8)+this.instr.osc2_det)*(1+8e-4*this.instr.osc2_detune),i=this.instr.fx_resonance/255,l=0,p=0,y=this.attack+this.sustain+this.release-1;y>=0;--y){var f=y+n,u=this.osc_lfo(f*this.lfoFreq)*this.instr.lfo_amt/512+.5,c=1;y<this.attack?c=y/this.attack:y>=this.attack+this.sustain&&(c-=(y-this.attack-this.sustain)/this.release);var d=r;this.instr.lfo_osc1_freq&&(d+=u),this.instr.osc1_xenv&&(d*=c*c),a+=d;var h=this.osc1(a)*this.instr.osc1_vol;d=s,this.instr.osc2_xenv&&(d*=c*c),o+=d,h+=this.osc2(o)*this.instr.osc2_vol,this.instr.noise_fader&&(h+=(2*Math.random()-1)*this.instr.noise_fader*c),h*=c/255;var m=this.instr.fx_freq;this.instr.lfo_fx_freq&&(m*=u);var x=i*(h-p)-(l+=(m=1.5*Math.sin(3.141592*m/44100))*p);switch(p+=m*x,this.instr.fx_filter){case 1:h=x;break;case 2:h=l;break;case 3:h=p;break;case 4:h=l+x}if(d=_(f*this.panFreq)*this.instr.fx_pan_amt/512+.5,h*=39*this.instr.env_master,(f*=4)+3<t.length){var g=t[f]+(t[f+1]<<8)+h*(1-d);t[f]=255&g,t[f+1]=g>>8&255,g=t[f+2]+(t[f+3]<<8)+h*d,t[f+2]=255&g,t[f+3]=g>>8&255}}},ge.SoundGenerator.prototype.getAudioGenerator=function(e,t){var n=this.attack+this.sustain+this.release-1+32*this.rowLen,a=this;w(n,function(o){a.genSound(e,o,0),R(o,n,a.instr,a.rowLen,function(){t(new ge.AudioGenerator(o))})})},ge.SoundGenerator.prototype.createAudioBuffer=function(e,t){this.getAudioGenerator(e,function(e){e.getAudioBuffer(t)})},ge.MusicGenerator=function(e){this.song=e,this.waveSize=44100*e.songLen},ge.MusicGenerator.prototype.generateTrack=function(e,t,n){var a=this;w(this.waveSize,function(o){var r=a.waveSize,s=a.waveSize*_e*2,i=a.song.rowLen,l=a.song.endPattern,p=new ge.SoundGenerator(e,i),y=0,f=0,u=0,c=function(){for(var t=new Date;;)if(32!==u){if(f===l-1)return void setTimeout(d,0);var n=e.p[f];if(n){var a=e.c[n-1].n[u];a&&p.genSound(a,o,y)}if(y+=i,u+=1,new Date-t>ve)return void setTimeout(c,0)}else u=0,f+=1},d=function(){R(o,r,e,i,m)},h=0,m=function(){for(var e=new Date,a=0;h<s;){var r=t[h]+(t[h+1]<<8)+o[h]+(o[h+1]<<8)-32768;if(t[h]=255&r,t[h+1]=r>>8&255,h+=2,(a+=1)%1e3==0&&new Date-e>ve)return void setTimeout(m,0)}setTimeout(n,0)};setTimeout(c,0)})},ge.MusicGenerator.prototype.getAudioGenerator=function(e){var t=this;w(this.waveSize,function(n){var a=0,o=function(){a<t.song.songData.length?(a+=1,t.generateTrack(t.song.songData[a-1],n,o)):e(new ge.AudioGenerator(n))};o()})},ge.MusicGenerator.prototype.createAudioBuffer=function(e){this.getAudioGenerator(function(t){t.getAudioBuffer(e)})},states={},init=(()=>{lcg=new g(1019),roomNG=new g,roomNG.setSeed(1019),sounds={},soundsLoaded=0,totalSounds=5,score=0,fuelTimer=0,parts=0,last=0,dt=0,now=0,t=0,state="loading",splodes=[],messages=[],help=[],tCounter=0,helpSection=0,paused=!1,transition=!1,gotFirst200=!1,s_titleSong=!1,s_gameSong=!1,s_jump=!1,s_step=!1,we=new AudioContext,x(),states.loading.init(),player.init(),loop()}),window.addEventListener("keyup",function(e){Key.onKeyup(e)},!1),window.addEventListener("keydown",function(e){Key.onKeydown(e)},!1),window.addEventListener("blur",function(e){paused=!0},!1),window.addEventListener("focus",function(e){paused=!1},!1),loop=(e=>{if(paused)ie=paldrk,B(["PAUSED",j/2,128,3,1,"center","top",4,21,0]);else{ie=te;let e=(new Date).getTime();dt=Math.min(1,(e-last)/1e3),t+=dt,states[state].step(dt),last=e,states[state].render()}m(),requestAnimationFrame(loop)});const Me=1,Ie=2,Ke=3,Se=4,De=1,be=2,Ge=3,Ne=4,Te=21,Ee=8,Le=9,Ae=4,Ce=27,Fe=28,ke=29,Oe=39,qe=39,Be=j/6,ze=j/6*3,je=j/6*5,Ue=U/4,Pe=U/4*2,Ye=U/4*3;rooms=[{draw:function(e){},specials:function(e){}},{draw:function(e){u(ze,Pe,je,Ye,Be,Ye,Te),u(je,Ye,ze,Pe,Be,Ye,Te),u(ze,Pe,Be,Ye,je,Ye,Te),l(0,Ye,j,Ue,Te)},specials:function(e){A(),E(0,Ye,j,Ue-10,20)}},{draw:function(e){F([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1]),n(25+325*Math.random(),U-36,Ee),n(25+325*Math.random(),U-36,Ee),n(25+325*Math.random(),U-36,Ee)},specials:function(e){A()}},{draw:function(e){l(0,170,384,200,Te),l(0,140,100,100,Te),n(192,160,Ce)},specials:function(e){A()}},{draw:function(e){F([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1])},specials:function(e){A()}},{draw:function(e){F([1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1])},specials:function(e){C()}},{draw:function(e){F([1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0]),n(200*Math.random()+70,U-40,Ce)},specials:function(e){C(),A()}},{draw:function(e){F([0,1,1,1,0,0,0,0,1,1,1,1,0,1,1,1,0,0,0,0,1,1,1,1,0,1,1,1,2,0,0,0,0,0,2,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,2,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1])},specials:function(e){C()}},{draw:function(e){F([1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1])},specials:function(e){C()}},{draw:function(e){F([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1])},specials:function(e){}}],player={init(){this.x=192,this.y=106,this.radius=8,this.hitRadius=8,this.xvel=0,this.yvel=0,this.xspeed=80,this.yspeed=80,this.drag=.8,this.gravity=8,this.maxYvel=400,this.maxXvel=200,this.minYvel=-400,this.minXvel=-200,this.b={},this.facingLeft=!1,this.jumping=!0,this.jumpCooldown=0,this.angle=0,this.mode=De,this.gunCooldown=0,this.minedFuel=!1,fuelTimer=40,currentRoom=[20,4]},update(e){Key.isDown(Key.ONE)&&(player.mode=De),Key.isDown(Key.TWO)&&(player.mode=be),Key.isDown(Key.THREE)&&(player.mode=Ge),Key.isDown(Key.FOUR)&&(player.mode=Ne),this.updateB(),this.oldX=this.x,this.oldY=this.y,this.xvel*=player.drag,this.yvel+=player.gravity,this.yvel=this.yvel.clamp(this.minYvel,this.maxYvel),this.xvel=this.xvel.clamp(this.minXvel,this.maxXvel);let t=e*player.xvel,o=e*player.yvel;if(player.x+=t,this.updateB(),this.collides()&&(player.x=player.oldX,player.xvel=.4*-player.xvel),player.y+=o,this.updateB(),this.collides()&&(player.y=player.oldY,player.yvel=.4*-player.yvel),this.updateB(),this.collides()&&(this.collideResolution(),this.updateB(),this.collides()&&(this.collideResolution(),this.updateB())),this.overlapResolution(),this.updateB(),player.yvel>0&&(s_step=!1,(ue[V+player.b.x+player.b.bottom*j]>0||ue[V+player.b.x+4+player.b.bottom*j]>0||ue[V+player.b.x-4+player.b.bottom*j]>0)&&(this.jumping=!1),player.mode==Ne)){let e=player.b.width;for(;e--;)ue[V+player.b.x+e+player.b.bottom*j]&&(this.jumping=!1)}switch(player.yvel<-10&&(splodes.push(new k(player.x+3+2*Math.random(),player.y+6+2*Math.random(),7,1,19)),splodes.push(new k(player.x-3-2*Math.random(),player.y+6+2*Math.random(),7,1,19)),s_step||(stepSound=h(sounds.step,1,player.x.map(0,j,-1,1),!1,.25),s_step=!0)),player.mode){case De:player.yspeed=80,player.xspeed=80,fuelTimer>=360&&(fuelTimer=360),(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.facingLeft=!1,this.jumping?player.xvel=player.xspeed:player.xvel=0),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(this.facingLeft=!0,this.jumping?player.xvel=-player.xspeed:player.xvel=0),(Key.isDown(Key.w)||Key.isDown(Key.UP)||Key.isDown(Key.z)||Key.isDown(Key.SPACE))&&!this.jumping&&fuelTimer>0&&player.jumpCooldown<0&&(this.jumping=!0,s_jump=!0,player.jumpCooldown=5,player.yvel=-player.yspeed,h(sounds.jump,2.5,player.x.map(0,j,-1,1),!1)),player.angle-=player.xvel/30,player.jumping&&(player.angle-=player.facingLeft?-player.yvel/30:player.yvel/30),player.jumpCooldown--,player.yvel>0&&ue[V+player.b.x+player.b.bottom*j]>0&&(this.jumping=!1);break;case be:helpSection=2,player.maxXvel=150,player.minYvel=-300,player.xspeed=150,player.yspeed=260,(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.facingLeft=!1,player.xvel=player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(this.facingLeft=!0,player.xvel=-player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP)||Key.isDown(Key.z)||Key.isDown(Key.SPACE))&&!this.jumping&&fuelTimer>0&&(fuelTimer-=1,this.jumping=!0,s_jump=!0,player.yvel=-player.yspeed,h(sounds.jump,2.5,player.x.map(0,j,-1,1),!1));break;case Ge:if(player.maxXvel=150,player.minYvel=-150,player.xspeed=150,player.yspeed=220,(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.facingLeft=!1,player.xvel=player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(this.facingLeft=!0,player.xvel=-player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP)||Key.isDown(Key.SPACE)||Key.isDown(Key.z))&&!this.jumping&&fuelTimer>0&&(fuelTimer-=.7,this.jumping=!0,s_jump=!0,player.yvel=-player.yspeed,h(sounds.jump,2.5,player.x.map(0,j,-1,1),!1)),Key.isDown(Key.x)){fuelTimer-=.01,splodes.push(new k(player.x+(player.facingLeft?-16:16)+(2*Math.random()-1)|0,player.y+(15*Math.random()-8)|0,6,5)),oe=V,a(player.b.x+(player.facingLeft?-10:10),player.b.y)==Le&&(player.minedFuel=!0),s(player.x+(player.facingLeft?-10:10),player.y+(20*Math.random()-15)|0,10,0);let e=5;for(;--e;)splodes.push(new k(player.x+(player.facingLeft?10*Math.random()-30:30+10*Math.random()),player.y+20*Math.random()-10,10+10*Math.random()-5,3*Math.random(),27+2*Math.random()|0,!1,!0));if(Key.isDown(Key.DOWN)||Key.isDown(Key.s)){splodes.push(new k(player.x+(15*Math.random()-8)|0,player.y+16+(2*Math.random()-1)|0,6,5)),oe=V,a(player.b.x+(player.facingLeft?-10:10),player.b.y)==Le&&(player.minedFuel=!0),s(player.x+(20*Math.random()-15)|0,player.y+10,10,0);let e=5;for(;--e;)splodes.push(new k(player.x+10*Math.random(),player.y+30+20*Math.random()-10,10+10*Math.random()-5,3*Math.random(),27+2*Math.random()|0,!1,!0))}player.gunCooldown<0&&(player.gunCooldown=4,h(sounds.zapgun,2.5,player.x.map(0,j,-1,1),!1),I())}player.minedFuel&&(n(player.x+(player.facingLeft?-10:10),player.y-5,Ee),fuelTimer+=25,player.minedFuel=!1),player.gunCooldown--;break;case Ne:if(player.maxXvel=250,player.minYvel=-250,player.xspeed=200,player.yspeed=200,(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.facingLeft=!1,player.xvel=player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(this.facingLeft=!0,player.xvel=-player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP)||Key.isDown(Key.Z)||Key.isDown(Key.SPACE))&&(player.jumping||(player.jumping=!0,player.yvel=-player.yspeed,s_jump=!0,h(sounds.jump,2.5,player.x.map(0,j,-1,1),!1))),Key.isDown(Key.x)){if(Key.isDown(Key.DOWN)||Key.isDown(Key.s)){splodes.push(new k(player.x+(15*Math.random()-8)|0,player.y+16+(2*Math.random()-1)|0,6,5)),oe=V,a(player.b.x+(player.facingLeft?-10:10),player.b.y)==Le&&(player.minedFuel=!0),s(player.x+(20*Math.random()-15)|0,player.y+10,10,0);let e=5;for(;--e;)splodes.push(new k(player.x+10*Math.random(),player.y+30+20*Math.random()-10,10+10*Math.random()-5,3*Math.random(),27+2*Math.random()|0,!1,!0))}else{fuelTimer-=.01,splodes.push(new k(player.x+(player.facingLeft?-16:16)+(2*Math.random()-1)|0,player.y+(15*Math.random()-8)|0,6,5)),oe=V,a(player.b.x+(player.facingLeft?-10:10),player.b.y)==Le&&(player.minedFuel=!0),s(player.x+(player.facingLeft?-10:10),player.y+(20*Math.random()-15)|0,10,0);let e=5;for(;--e;)splodes.push(new k(player.x+(player.facingLeft?10*Math.random()-30:30+10*Math.random()),player.y+20*Math.random()-10,10+10*Math.random()-5,3*Math.random(),27+2*Math.random()|0,!1,!0))}player.gunCooldown<0&&(player.gunCooldown=4,h(sounds.zapgun,2.5,player.x.map(0,j,-1,1),!1),I())}if(Key.isDown(Key.c)){if(Key.isDown(Key.DOWN)||Key.isDown(Key.s)){splodes.push(new k(player.x+(15*Math.random()-8)|0,player.y+16+(2*Math.random()-1)|0,6,5)),oe=V,a(player.b.x+(player.facingLeft?-10:10),player.b.y)==Le&&(player.minedFuel=!0),s(player.x+(20*Math.random()-15)|0,player.y+20,10,Te);let e=5;for(;--e;)splodes.push(new k(player.x+10*Math.random(),player.y+30+20*Math.random()-10,10+10*Math.random()-5,3*Math.random(),9+2*Math.random()|0,!1,!0))}else{fuelTimer-=.2,splodes.push(new k(player.x+(player.facingLeft?-16:16)+(2*Math.random()-1)|0,player.y+(15*Math.random()-8)|0,6,5)),oe=V,s(player.x+(player.facingLeft?-10-player.radius:10+player.radius),player.y+(20*Math.random()-15)|0,10,Te);let e=5;for(;--e;)splodes.push(new k(player.x+(player.facingLeft?10*Math.random()-30:30+10*Math.random()),player.y+20*Math.random()-10,10+10*Math.random()-5,3*Math.random(),9+3*Math.random()|0,!1,!0))}player.gunCooldown<0&&(player.gunCooldown=4,h(sounds.zapgun,2.5,player.x.map(0,j,-1,1),!1),I())}if(player.minedFuel){n(player.x+(player.facingLeft?-10:10),player.y-5,Ee),fuelTimer+=25,player.minedFuel=!1;let e=10;for(;--e;)splodes.push(new k(192+50*Math.random()-25,14+4*Math.random()-2,10+4*Math.random()-2,10+4*Math.random()-2,2*Math.random()-1+9|0,!1,!0))}player.gunCooldown--}player.x>j&&(player.x=0,M(Ie)),player.x<0&&(player.x=j,M(Me)),player.y>U&&(player.y=0,M(Se)),player.y<0&&(player.y=U,M(Ke))},draw(e){switch(i(player.b.x-this.radius,player.b.y-this.radius,2*this.radius,2*this.radius,27),player.mode){case De:re=J,d(0,0,32,32,player.x,player.y,1,player.angle);break;case be:re=J,c(32,0,32,32,player.b.x+2-16,player.b.y+5-20),c(0,0,32,32,player.b.x-16,player.b.y-20,player.facingLeft);break;case Ge:re=J,c(32,0,32,32,player.b.x+2-16,player.b.y+5-20),c(96,0,32,32,player.b.x+5-16+(this.facingLeft?-12:0),player.b.y+3-20,this.facingLeft),c(0,0,32,32,player.b.x-16,player.b.y-20,player.facingLeft);break;case Ne:re=J,c(128,0,32,40,player.b.x+5-16,player.b.y+4-20),c(32,0,32,32,player.b.x+2-16,player.b.y+5-20),c(64,0,32,32,player.b.x+5-16,player.b.y+4-20),c(96,0,32,32,player.b.x+5-16+(this.facingLeft?-12:0),player.b.y+3-20,this.facingLeft),c(0,0,32,32,player.b.x-16,player.b.y-20,player.facingLeft)}},collides(){this.b.x+this.hitRadius>=j-1&&player.xvel>0&&(this.x=j+1);for(var e=-this.hitRadius;e<this.hitRadius;e++)for(var t=-this.hitRadius;t<this.hitRadius;t++){let n=ue[V+(this.b.x+e)+(this.b.y+t)*j];if(n==Te||n==Ae||n==Le)return!0}return!1},overlaps(){for(var e=-this.radius;e<this.radius;e++)for(var t=2*-this.radius;t<this.radius;t++){let n=ue[V+(this.b.x+e)+(this.b.y+t)*j];if(n)return{x:this.b.x+e,y:this.b.y+t,o:n}}return!1},updateB(){this.b={left:this.x-this.hitRadius|0,right:this.x+this.hitRadius|0,top:this.y-this.hitRadius|0,bottom:this.y+this.hitRadius|0,width:2*this.hitRadius,height:2*this.hitRadius,x:0|this.x,y:0|this.y}},collideResolution(e){oe=V,l(player.x-32,player.y-32,64,64,0),I()},overlapResolution(e){let t=player.overlaps();switch(t.o){case Ee:oe=V,ue[V+t.x+t.y*j],s(t.x,t.y,3,0),oe=H,splodes.push(new k(t.x,t.y)),h(sounds.fuelget,2,player.x.map(0,j,-1,1),!1);let e=10;for(;--e;)splodes.push(new k(192+50*Math.random()-25,14+4*Math.random()-2,10+4*Math.random()-2,10+4*Math.random()-2,2*Math.random()-1+9|0,!1,!0));fuelTimer+=25;break;case Ce:ue[V+t.x+t.y*j],oe=V,s(t.x,t.y,3,0),oe=H,player.mode=be,messages.push(new O("AUX BOOSTERS ACQUIRED. ENERGY CAPACITY INCREASED.")),h(sounds.fuelget,1,player.x.map(0,j,-1,1),!1);break;case Fe:ue[V+t.x+t.y*j],oe=V,s(t.x,t.y,3,0),oe=H,player.mode=Ge,h(sounds.fuelget,1,player.x.map(0,j,-1,1),!1),messages.push(new O("DISINTIGRATE TOOL ACQUIRED. PRESS X TO USE"));break;case ke:ue[V+t.x+t.y*j],oe=V,s(t.x,t.y,3,0),oe=H,player.mode=Ne,h(sounds.fuelget,1,player.x.map(0,j,-1,1),!1),messages.push(new O("E-M CONVERTER ACQUIRED. PRESS C TO USE"))}}},k.prototype.draw=function(e){if(++this.size>this.maxSize)return splodes.splice(e,1);this.square?this.filled?l(this.x-this.size/2,this.y-this.size/2,this.size,this.size,this.color):i(this.x-this.size/2,this.y-this.size/2,this.size,this.size,this.color):this.filled?s(this.x,this.y,this.size,this.color):r(this.x,this.y,this.size,this.color),0==--this.counter&&(this.size++,this.counter=this.speed)},O.prototype.draw=function(e){if(oe=X,this.time--,this.counter+=2,this.time<0)return messages.splice(e,1);this.string=this.text.substring(0,this.counter),B([this.string,j/2,20+12*e,2,2,"center","top",1,this.color])},states.gameover={step:function(e){Key.isDown(Key.r)&&(state="menu")},render:function(t){oe=0,e(0),B(["CRITICAL SYSTEM\nFAILURE",192,80,8,15,"center","top",3,27])}},states.menu={step:function(e){if(Key.justReleased(Key.p)){let e=10;for(;e--;)splodes.push(new k(player.x+40*Math.random()-20,player.y+40*Math.random()-20,200,1,5)),splodes.push(new k(player.x+40*Math.random()-20,player.y+40*Math.random()-20,200,1,8)),splodes.push(new k(player.x+40*Math.random()-20,player.y+40*Math.random()-20,32,1,21,!0)),splodes.push(new k(player.x+40*Math.random()-20,player.y+40*Math.random()-20,25,1,0,!0));h(sounds.boom,1,player.x.map(0,j,-1,1),!1),M(),state="game"}},render:function(a){oe=V,e(0),oe=0,e(0),oe=H,e(0),oe=W,e(0),oe=X,e(0),oe=V,l(0,128,j,10,2),B(["GREEBLE",j/2,50,14,20,"center","top",7,2]),oe=H,re=V,c(),oe=Q,lcg.setSeed(21);for(o=6e3;--o;){let e=lcg.nextIntRange(0,j),t=lcg.nextIntRange(0,U);ue[V+e+t*j]&&l(e+lcg.nextIntRange(-2,2),t+lcg.nextIntRange(-1,1),1,lcg.nextIntRange(0,3),lcg.nextIntRange(24,25))}f(Q,W,25,20,23,18),oe=H,re=Q,c(),re=W,c(),oe=Q,lcg.setSeed(20);for(var o=6e3;--o;){let e=lcg.nextIntRange(0,j),t=lcg.nextIntRange(0,U);ue[V+e+t*j]&&l(e+lcg.nextIntRange(-1,1),t+lcg.nextIntRange(0,1),lcg.nextIntRange(1,5),1,lcg.nextIntRange(22,24))}f(Q,W,25,20,23,18),oe=H,re=Q,c(),re=W,c(),re=J;let r=15;for(;--r;)c(160,0,32,40,(32*r+16*t|0)%j,90),(32*r+16*t|0)%j==j-1&&(splodes.push(new k(16,100)),splodes.push(new k(16,116)));B(["PRESS P TO CONTINUE",j/2,230,2,2,"center","top",1,21]),oe=X;for(s=8e3;--s;)n((lcg.nextIntRange(0,384)+10*t|0)%384,lcg.nextIntRange(0,256),1);for(s=400;--s;)n((lcg.nextIntRange(0,384)+20*t|0)%384,lcg.nextIntRange(0,256),26);for(var s=100;--s;)n((lcg.nextIntRange(0,384)+30*t|0)%384,lcg.nextIntRange(0,256),21);f(H,X,15),re=H,c(),splodes.forEach(function(e,t,n){e.draw(t)})}},states.game={messageDelay:240,messageIndex:0,helpLoops:[["CRITICAL SYSTEM FAILURE IMMINENT.","FIND FUEL SOURCE.","AUX JETS OFFLINE. HOLD LEFT/RIGHT\nTAP JUMP TO MOVE"],["MAX ENERGY CAPACITY REACHED.","FIND MISSING COMPONENTS TO INCREASE CAPACITY"],["FIND MORE FUEL","SEEK OUT REMAINING BODY COMPONENTS"],[""]],step(e){Key.isDown(Key.r)&&(player.init(),state="menu"),player.update(e),fuelTimer-=e,fuelTimer>200&&!gotFirst200&&(gotFirst200=!0,helpSection=1),--this.messageDelay<0&&(messages.push(new O(this.helpLoops[helpSection][this.messageIndex],fuelTimer<50?27:9,240)),this.messageDelay=240,++this.messageIndex>this.helpLoops[helpSection].length&&(this.messageIndex=0))},render(t){if(oe=X,e(0),re=ee,c(),L(),oe=H,e(0),S(),re=Z,c(),player.draw(),re=$,c(),oe=X,fuelTimer>0){if(fuelTimer>15)re=H,c();else if(Math.random()>fuelTimer/15){oe=X,e(0);let t=1e3;for(;t--;)n(Math.random()*j,Math.random()*U,27);for(t=6e3;t--;){let e=Math.random()*j,t=Math.random()*U;n(e,t,ue[H+e+t*j]>0?28:0)}}}else state="gameover";oe=X,B([fuelTimer.toFixed(2).toString(),j/2,10,2,2,"center","top",1,fuelTimer<150?27:10]),splodes.forEach(function(e,t,n){e.draw(t)}),messages.forEach(function(e,t,n){e.draw(t)})}},states.loading={init:function(e){var t=new ge.MusicGenerator(de);t.createAudioBuffer(function(e){sounds.zapgun=e,soundsLoaded++}),(t=new ge.MusicGenerator(he)).createAudioBuffer(function(e){sounds.fuelget=e,soundsLoaded++});var n=new ge.SoundGenerator(ce);n.createAudioBuffer(147,function(e){we.createBufferSource();sounds.jump=e,soundsLoaded++}),(n=new ge.SoundGenerator(me)).createAudioBuffer(147,function(e){we.createBufferSource();sounds.boom=e,soundsLoaded++}),(n=new ge.SoundGenerator(xe)).createAudioBuffer(147,function(e){we.createBufferSource();sounds.step=e,soundsLoaded++})},step:function(e){Key.justReleased(Key.z)&&soundsLoaded==totalSounds&&(state="menu"),--tCounter<0&&soundsLoaded!=totalSounds&&(tCounter=9,splodes.push(new k(j/2+100*Math.cos(t),U/2+70*Math.sin(t),300,1,12)))},render:function(n){oe=X,e(0),soundsLoaded!=totalSounds?(oe=X,e(0),splodes.forEach(function(e){e.draw()}),B(["LOADING...",j/2,128+20*Math.sin(t),3,2,"center","top",3,9])):(splodes.forEach(function(e){e.draw()}),B(["HEADPHONES RECOMMENDED.\nPRESS Z TO CONTINUE",j/2,128+20*Math.sin(t),2,10,"center","top",2,9]))}},states.spritesheet={step:function(e){Key.isDown(Key.x)&&(M(),state="menu"),Key.isDown(Key.p)&&(state="game")},render:function(n){oe=X,e(0),re=J,c(),c(0,0,22,34,300,100),d(0,0,32,32,16,112,1,15+90*t),d(32,0,32,32,48,112,1,15+90*t),d(64,0,32,32,80,112,1,15+90*t);for(var a=0;a<32;a++)B([a.toString(),a<16?3+16*a:3+16*(a-16),a<16?200:216,1,1,1,"left",1,a,0])}},Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,ONE:49,TWO:50,THREE:51,FOUR:52,a:65,c:67,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,isDown(e){return this._pressed[e]},justReleased(e){return this._released[e]},onKeydown(e){this._pressed[e.keyCode]=!0},onKeyup(e){this._released[e.keyCode]=!0,delete this._pressed[e.keyCode]},update(){this._released={}}},window.onload=init()}();
</script></body></html>