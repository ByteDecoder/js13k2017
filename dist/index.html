<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>JS13K 2017 boilerplate</title><style>
body{margin:0;overflow:hidden;background:#111;color:#ccc}#canvas{position:fixed;top:50%;bottom:0;left:50%;right:0;width:768px;height:512px;transform:translate(-50%,-50%);image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor;cursor:none;margin:auto}
</style></head><body><canvas id="canvas"></canvas><script>
var Stats=function(){function e(e){return n.appendChild(e.dom),e}function t(e){for(var t=0;t<n.children.length;t++)n.children[t].style.display=t===e?"block":"none";o=e}var o=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",function(e){e.preventDefault(),t(++o%n.children.length)},!1);var r=(performance||Date).now(),a=r,s=0,f=e(new Stats.Panel("FPS","#0ff","#002")),_=e(new Stats.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var i=e(new Stats.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:n,addPanel:e,showPanel:t,begin:function(){r=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(_.update(e-r,200),e>a+1e3&&(f.update(1e3*s/(e-a),100),a=e,s=0,i)){var t=performance.memory;i.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){r=this.end()},domElement:n,setMode:t}};Stats.Panel=function(e,t,o){var n=1/0,r=0,a=Math.round,s=a(window.devicePixelRatio||1),f=80*s,_=48*s,i=3*s,c=2*s,u=3*s,l=15*s,v=74*s,m=30*s,h=document.createElement("canvas");h.width=f,h.height=_,h.style.cssText="width:80px;height:48px";var d=h.getContext("2d");return d.font="bold "+9*s+"px Helvetica,Arial,sans-serif",d.textBaseline="top",d.fillStyle=o,d.fillRect(0,0,f,_),d.fillStyle=t,d.fillText(e,i,c),d.fillRect(u,l,v,m),d.fillStyle=o,d.globalAlpha=.9,d.fillRect(u,l,v,m),{dom:h,update:function(_,x){n=Math.min(n,_),r=Math.max(r,_),d.fillStyle=o,d.globalAlpha=1,d.fillRect(0,0,f,l),d.fillStyle=t,d.fillText(a(_)+" "+e+" ("+a(n)+"-"+a(r)+")",i,c),d.drawImage(h,u+s,l,v-s,m,u,l,v-s,m),d.fillRect(u+v-s,l,s,m),d.fillStyle=o,d.globalAlpha=.9,d.fillRect(u+v-s,l,s,a((1-_/x)*m))}}},"object"==typeof module&&(module.exports=Stats),function(){function e(e){return Math.sin(6.283184*e)}function o(e){return.00390625*Math.pow(1.059463094,e-128)}function n(e,t){setTimeout(function(){var o=new Uint8Array(e*y*2),n=o.length-2,r=function(){for(var e=new Date,a=0;n>=0;)if(o[n]=0,o[n+1]=128,n-=2,(a+=1)%1e3==0&&new Date-e>p)return void setTimeout(r,0);setTimeout(function(){t(o)},0)};setTimeout(r,0)},0)}function r(e,t,o,n,r){var a=o.fx_delay_time*n>>1,s=o.fx_delay_amt/255,f=0,_=function(){for(var o=new Date,n=0;f<t-a;){var i=4*f,c=4*(f+a),u=e[c]+(e[c+1]<<8)+(e[i+2]+(e[i+3]<<8)-32768)*s;if(e[c]=255&u,e[c+1]=u>>8&255,u=e[c+2]+(e[c+3]<<8)+(e[i]+(e[i+1]<<8)-32768)*s,e[c+2]=255&u,e[c+3]=u>>8&255,++f,(n+=1)%1e3==0&&new Date-o>p)return void setTimeout(_,0)}setTimeout(r,0)};setTimeout(_,0)}function a(e){O.fill(e,k,k+131072)}function s(e,t,o){t|=0,o|=0,(e|=0)>0&&e<K&&t>0&&t<b&&(O[k+(t*K+e)]=o)}function f(e,t,o,n,r){var a,f,_=(n|=0)-(t|=0),i=(o|=0)-(e|=0);if(_<0?(_=-_,f=-1):f=1,i<0?(i=-i,a=-1):a=1,_<<=1,i<<=1,s(e,t,r),i>_)for(var c=_-(i>>1);e!=o;)c>=0&&(t+=f,c-=i),c+=_,s(e+=a,t,r);else for(c=i-(_>>1);t!=n;)c>=0&&(e+=a,c-=_),c+=i,s(e,t+=f,r)}function _(e,t,o,n){if(!(o<0)){e|=0,t|=0,n|=0;var r=-(o|=0),a=0,s=2-2*o;do{f(e-r,t-a,e+r,t-a,n),f(e-r,t+a,e+r,t+a,n),(o=s)<=a&&(s+=2*++a+1),(o>r||s>a)&&(s+=2*++r+1)}while(r<0)}}function c(e,t,o,n,r){x1=0|e,y1=0|t,x2=e+o|0,y2=t+n|0;var a=Math.abs(y2-y1);if(f(x1,y1,x2,y1,r),a>0)for(;--a;)f(x1,y1+a,x2,y1+a,r);f(x1,y2,x2,y2,r)}function u(e,t,o,n,r,a,s){var f=K,e=Math.round(16*e),o=Math.round(16*o),r=Math.round(16*r),t=Math.round(16*t),_=e-o,i=(n=Math.round(16*n))-t,c=o-r,u=(a=Math.round(16*a))-n,l=r-e,v=t-a,m=Math.max(Math.min(e,o,r)+15>>4,0),h=Math.min(Math.max(e,o,r)+15>>4,K),d=Math.max(Math.min(t,n,a)+15>>4,0),x=Math.min(Math.max(t,n,a)+15>>4,b);m&=-8,d&=-8;var y=-i*e-_*t,p=-u*o-c*n,w=-v*r-l*a;(i>0||0==i&&_>0)&&y++,(u>0||0==u&&c>0)&&p++,(v>0||0==v&&l>0)&&w++,y=y-1>>4,p=p-1>>4,w=w-1>>4;var q=0,M=0,R=0,T=0,D=0,S=0;_>=0?M-=7*_:q-=7*_,i>=0?M-=7*i:q-=7*i,c>=0?T-=7*c:R-=7*c,u>=0?T-=7*u:R-=7*u,l>=0?S-=7*l:D-=7*l,v>=0?S-=7*v:D-=7*v;for(var g=f-8,A=d;A<x;A+=8)for(var E=m;E<h;E+=8){var P=y+_*A+i*E,C=p+c*A+u*E,U=w+l*A+v*E;if(!(P<M||C<T||U<S)){var B=E+A*f;if(P>=q&&C>=R&&U>=D)for(I=0;I<8;I++){for(G=0;G<8;G++,B++)O[k+B]=s;B+=g}else for(var I=0;I<8;I++){for(var L=P,N=C,F=U,G=0;G<8;G++)(L|N|F)>=0&&(O[k+B]=s),L+=i,N+=u,F+=v,B++;P+=_,C+=c,U+=l,B+=g}}}}function l(){for(var e=R;e--;)C[e]=S[g[O[e]]];A.data.set(P),D.putImageData(A,0,0)}function v(e){switch(e){case U:currentRoom[0]--,currentRoom[0]<0&&(currentRoom[0]=N),console.log(currentRoom);break;case B:currentRoom[0]++,currentRoom[0]>N&&(currentRoom[0]=0),console.log(currentRoom);break;case I:currentRoom[1]--,currentRoom[1]<0&&(currentRoom[1]=F),console.log(currentRoom);break;case L:currentRoom[1]++,currentRoom[1]>F&&(currentRoom[1]=0),console.log(currentRoom)}}function m(e){for(var t=e[0].length,o=0;o<t;o++){var n=[];n=d(e[0].charAt(o));for(var r=0;r<5;r++)for(var a=0;a<5;a++)1==n[5*r+a]&&(1==e[4]?s(e[1]+a*e[4]+(5*e[4]+e[3])*o,e[2]+r*e[4],e[5]):c(e[1]+a*e[4]+(5*e[4]+e[3])*o,e[2]+r*e[4],e[4],e[4],e[5]))}}function h(e){var t=5*e[7],o=e[0].split("\n"),n=o.slice(0),r=o.length,a=n.sort(function(e,t){return t.length-e.length})[0],s=a.length*t+(a.length-1)*e[3],f=r*t+(r-1)*e[4];e[5]||(e[5]="left"),e[6]||(e[6]="bottom");var _=e[1],i=e[2],c=e[1]+s,u=e[2]+f;"center"==e[5]?(_=e[1]-s/2,c=e[1]+s/2):"right"==e[5]&&(_=e[1]-s,c=e[1]),"center"==e[6]?(i=e[2]-f/2,u=e[2]+f/2):"bottom"==e[6]&&(i=e[2]-f,u=e[2]);for(var l=_+s/2,v=i+f/2,h=0;h<r;h++){var d=o[h],x=d.length*t+(d.length-1)*e[3],y=e[1],p=e[2]+(t+e[4])*h;"center"==e[5]?y=e[1]-x/2:"right"==e[5]&&(y=e[1]-x),"center"==e[6]?p-=f/2:"bottom"==e[6]&&(p-=f),m([d,y,p,e[3]||0,e[7]||1,e[8],e[9]])}return{sx:_,sy:i,cx:l,cy:v,ex:c,ey:u,width:s,height:f}}function d(e){return index=fontString.indexOf(e),fontBitmap.substring(25*index,25*index+25).split("")}var x={},y=2,p=33,w=null,q=[e,function(t){return e(t)<0?-1:1},function(e){return e%1-.5},function(e){var t=e%1*4;return t<2?t-1:3-t}];x.AudioGenerator=function(e){this.mixBuf=e,this.waveSize=e.length/y/2},x.AudioGenerator.prototype.getAudioBuffer=function(e){null===w&&(w=new AudioContext);var t=this.mixBuf,o=this.waveSize*y*2,n=w.createBuffer(y,this.waveSize,44100),r=n.getChannelData(0),a=n.getChannelData(1),s=0,f=function(){for(var _=new Date,i=0;s<o/2;){var c=4*(t[4*s]+(t[4*s+1]<<8)-32768);if(c=c<-32768?-32768:c>32767?32767:c,r[s]=c/32768,c=4*(t[4*s+2]+(t[4*s+3]<<8)-32768),c=c<-32768?-32768:c>32767?32767:c,a[s]=c/32768,s+=1,(i+=1)%1e3==0&&new Date-_>p)return void setTimeout(f,0)}setTimeout(function(){e(n)},0)};setTimeout(f,0)},x.SoundGenerator=function(e,t){this.instr=e,this.rowLen=t||5605,this.osc_lfo=q[e.lfo_waveform],this.osc1=q[e.osc1_waveform],this.osc2=q[e.osc2_waveform],this.attack=e.env_attack,this.sustain=e.env_sustain,this.release=e.env_release,this.panFreq=Math.pow(2,e.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,e.lfo_freq-8)/this.rowLen},x.SoundGenerator.prototype.genSound=function(t,n,r){new Date;for(var a=0,s=0,f=o(t+12*(this.instr.e-8)+this.instr.t)*(1+8e-4*this.instr.o),_=o(t+12*(this.instr.osc2_oct-8)+this.instr.osc2_det)*(1+8e-4*this.instr.osc2_detune),i=this.instr.fx_resonance/255,c=0,u=0,l=this.attack+this.sustain+this.release-1;l>=0;--l){var v=l+r,m=this.osc_lfo(v*this.lfoFreq)*this.instr.lfo_amt/512+.5,h=1;l<this.attack?h=l/this.attack:l>=this.attack+this.sustain&&(h-=(l-this.attack-this.sustain)/this.release);var d=f;this.instr.lfo_osc1_freq&&(d+=m),this.instr.osc1_xenv&&(d*=h*h),a+=d;var x=this.osc1(a)*this.instr.osc1_vol;d=_,this.instr.osc2_xenv&&(d*=h*h),s+=d,x+=this.osc2(s)*this.instr.osc2_vol,this.instr.noise_fader&&(x+=(2*Math.random()-1)*this.instr.noise_fader*h),x*=h/255;var y=this.instr.fx_freq;this.instr.lfo_fx_freq&&(y*=m);var p=i*(x-u)-(c+=(y=1.5*Math.sin(3.141592*y/44100))*u);switch(u+=y*p,this.instr.fx_filter){case 1:x=p;break;case 2:x=c;break;case 3:x=u;break;case 4:x=c+p}if(d=e(v*this.panFreq)*this.instr.fx_pan_amt/512+.5,x*=39*this.instr.env_master,(v*=4)+3<n.length){var w=n[v]+(n[v+1]<<8)+x*(1-d);n[v]=255&w,n[v+1]=w>>8&255,w=n[v+2]+(n[v+3]<<8)+x*d,n[v+2]=255&w,n[v+3]=w>>8&255}}},x.SoundGenerator.prototype._=function(e,t){var o=this.attack+this.sustain+this.release-1+32*this.rowLen,a=this;n(o,function(n){a.genSound(e,n,0),r(n,o,a.instr,a.rowLen,function(){t(new x.AudioGenerator(n))})})},x.SoundGenerator.prototype.createAudioBuffer=function(e,t){this._(e,function(e){e.getAudioBuffer(t)})},x.i=function(e){this.song=e,this.waveSize=44100*e.songLen},x.i.prototype.generateTrack=function(e,t,o){var a=this;n(this.waveSize,function(n){var s=a.waveSize,f=a.waveSize*y*2,_=a.song.rowLen,i=a.song.endPattern,c=new x.SoundGenerator(e,_),u=0,l=0,v=0,m=function(){for(var t=new Date;;)if(32!==v){if(l===i-1)return void setTimeout(h,0);var o=e.p[l];if(o){var r=e.c[o-1].n[v];r&&c.genSound(r,n,u)}if(u+=_,v+=1,new Date-t>p)return void setTimeout(m,0)}else v=0,l+=1},h=function(){r(n,s,e,_,w)},d=0,w=function(){for(var e=new Date,r=0;d<f;){var a=t[d]+(t[d+1]<<8)+n[d]+(n[d+1]<<8)-32768;if(t[d]=255&a,t[d+1]=a>>8&255,d+=2,(r+=1)%1e3==0&&new Date-e>p)return void setTimeout(w,0)}setTimeout(o,0)};setTimeout(m,0)})},x.i.prototype._=function(e){var t=this;n(this.waveSize,function(o){var n=0,r=function(){n<t.song.songData.length?(n+=1,t.generateTrack(t.song.songData[n-1],o,r)):e(new x.AudioGenerator(o))};r()})},x.i.prototype.createAudioBuffer=function(e){this._(function(t){t.getAudioBuffer(e)})};var M={songLen:37,songData:[{e:7,t:0,o:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:3,osc2_oct:7,osc2_det:0,osc2_detune:7,osc2_xenv:0,osc2_vol:201,osc2_waveform:3,noise_fader:0,env_attack:789,env_sustain:1234,env_release:13636,env_master:191,fx_filter:2,fx_freq:5839,fx_resonance:254,fx_delay_time:6,fx_delay_amt:121,fx_pan_freq:6,fx_pan_amt:147,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:6,lfo_amt:195,lfo_waveform:0,p:[1,2,0,0,1,2,1,2],c:[{n:[154,0,154,0,152,0,147,0,0,0,0,0,0,0,0,0,154,0,154,0,152,0,157,0,0,0,156,0,0,0,0,0]},{n:[154,0,154,0,152,0,147,0,0,0,0,0,0,0,0,0,154,0,154,0,152,0,157,0,0,0,159,0,0,0,0,0]}]},{e:7,t:0,o:0,osc1_xenv:0,osc1_vol:255,osc1_waveform:2,osc2_oct:8,osc2_det:0,osc2_detune:18,osc2_xenv:1,osc2_vol:191,osc2_waveform:2,noise_fader:0,env_attack:3997,env_sustain:56363,env_release:1e5,env_master:255,fx_filter:2,fx_freq:392,fx_resonance:255,fx_delay_time:8,fx_delay_amt:69,fx_pan_freq:5,fx_pan_amt:67,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:4,lfo_amt:57,lfo_waveform:3,p:[1,2,1,2,1,2,1,2],c:[{n:[130,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{n:[123,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]},{e:8,t:0,o:0,osc1_xenv:0,osc1_vol:0,osc1_waveform:0,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:60,env_attack:50,env_sustain:419,env_release:4607,env_master:130,fx_filter:1,fx_freq:10332,fx_resonance:120,fx_delay_time:4,fx_delay_amt:16,fx_pan_freq:5,fx_pan_amt:108,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:5,lfo_amt:187,lfo_waveform:0,p:[0,0,0,0,1,1],c:[{n:[0,0,147,0,0,0,147,147,0,0,147,0,0,147,0,147,0,0,147,0,0,0,147,147,0,0,147,0,0,147,0,147]}]},{e:7,t:0,o:0,osc1_xenv:1,osc1_vol:255,osc1_waveform:0,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:255,osc2_waveform:0,noise_fader:0,env_attack:50,env_sustain:150,env_release:4800,env_master:200,fx_filter:2,fx_freq:600,fx_resonance:254,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1,1,1,1,1,1],c:[{n:[147,0,0,0,0,0,0,0,147,0,0,0,0,0,0,0,147,0,0,0,0,0,0,0,147,0,0,0,0,0,0,0]}]},{e:7,t:0,o:0,osc1_xenv:0,osc1_vol:255,osc1_waveform:2,osc2_oct:7,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:154,osc2_waveform:2,noise_fader:0,env_attack:2418,env_sustain:1075,env_release:10614,env_master:240,fx_filter:3,fx_freq:2962,fx_resonance:255,fx_delay_time:6,fx_delay_amt:117,fx_pan_freq:3,fx_pan_amt:73,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:5,lfo_amt:124,lfo_waveform:0,p:[0,0,0,0,1,2,1,2],c:[{n:[154,0,154,0,152,0,147,0,0,0,0,0,0,0,0,0,154,0,154,0,152,0,157,0,0,0,156,0,0,0,0,0]},{n:[154,0,154,0,152,0,147,0,0,0,0,0,0,0,0,0,154,0,147,0,152,0,157,0,0,0,159,0,0,0,0,0]}]},{e:7,t:0,o:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:1,osc2_oct:6,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:137,env_sustain:2e3,env_release:4611,env_master:192,fx_filter:1,fx_freq:982,fx_resonance:89,fx_delay_time:6,fx_delay_amt:25,fx_pan_freq:6,fx_pan_amt:77,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:69,lfo_waveform:0,p:[1,2,1,3,1,3],c:[{n:[130,0,130,0,142,0,130,130,0,142,130,0,142,0,130,0,130,0,130,0,142,0,130,130,0,142,130,0,142,0,130,0]},{n:[123,0,123,0,135,0,123,123,0,135,123,0,135,0,123,0,123,0,123,0,135,0,123,123,0,135,123,0,135,0,123,0]},{n:[135,0,135,0,147,0,135,135,0,147,135,0,147,0,135,0,135,0,135,0,147,0,135,135,0,147,135,0,147,0,135,0]}]},{e:7,t:0,o:0,osc1_xenv:0,osc1_vol:255,osc1_waveform:3,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:255,osc2_waveform:0,noise_fader:127,env_attack:22,env_sustain:88,env_release:3997,env_master:255,fx_filter:3,fx_freq:4067,fx_resonance:234,fx_delay_time:4,fx_delay_amt:33,fx_pan_freq:2,fx_pan_amt:84,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:28,lfo_waveform:0,p:[0,0,1,2,1,2,1,3],c:[{n:[0,0,142,0,154,0,0,0,142,0,0,0,154,0,0,0,0,0,142,0,154,0,0,0,142,0,0,0,154,0,0,0]},{n:[0,0,147,0,154,0,0,0,147,0,0,0,154,0,0,0,0,0,147,0,154,0,147,0,0,0,154,0,0,0,154,0]},{n:[0,0,147,0,154,0,0,0,147,0,0,0,154,0,0,0,0,0,147,0,154,0,0,0,147,0,0,0,0,0,0,0]}]},{e:8,t:0,o:0,osc1_xenv:0,osc1_vol:0,osc1_waveform:0,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:255,env_attack:140347,env_sustain:9216,env_release:133417,env_master:208,fx_filter:2,fx_freq:2500,fx_resonance:16,fx_delay_time:2,fx_delay_amt:157,fx_pan_freq:8,fx_pan_amt:207,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:2,lfo_amt:51,lfo_waveform:0,p:[0,0,1,1,1,1,1,1],c:[{n:[147,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],rowLen:5513,endPattern:9};fontString="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_!@.'\"?/<()",fontBitmap="11111100011111110001100011111010001111101000111110111111000010000100000111111100100101000110001111101111110000111001000011111111111000011100100001000011111100001011110001111111000110001111111000110001111110010000100001001111111111000100001010010111101000110010111001001010001100001000010000100001111110001110111010110001100011000111001101011001110001011101000110001100010111011110100011001011100100000111010001100011001001111111101000111110100011000101111100000111000001111101111100100001000010000100100011000110001100010111010001100011000101010001001000110001101011010101110100010101000100010101000110001010100010000100001001111100010001000100011111001000110000100001000111001110100010001000100111111111000001001100000111110100101001011111000100001011111100001111000001111100111110000111101000101110111110000100010001000010001110100010111010001011100111010001011110000101110011101000110001100010111000000000000000000000111110010000100001000000000100111111000110111101011011101010111110101011111010100000000000000000000000100001100001000100000000000011011010011001000000000000111010001001100000000100000010001000100010001000000010001000100000100000100001000100001000010000010";const K=384,b=256,R=K*b;var T=document.getElementById("canvas"),D=T.getContext("2d"),k=0,S=[4278190080,4281606178,4282132549,4281416038,4282078863,4280709599,4284915929,4288332782,4281791227,4283491737,4281384554,4285436983,4281297227,4280568658,4281941042,4285808447,4286734384,4292963931,4294941539,4293184863,4294761419,4294967295,4290227611,4287069828,4285164137,4283586137,4287251062,4281479852,4284700633,4290411479,4283078543,4281364362],g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31];D.imageSmoothingEnabled=!1,D.mozImageSmoothingEnabled=!1,T.width=K,T.height=b;var A=D.getImageData(0,0,K,b),E=new ArrayBuffer(A.data.length),P=new Uint8Array(E),C=new Uint32Array(E),O=new Uint8ClampedArray(K*b*8);const U=1,B=2,I=3,L=4,N=2,F=2;states={},init=(()=>{last=0,dt=0,now=0,t=0,songTrigger=!1,state="game",w=new AudioContext,currentRoom=[0,0],player.init(),stats=new Stats,document.body.appendChild(stats.dom),loop()}),stopCapture=(e=>{}),window.addEventListener("keyup",function(e){Key.onKeyup(e)},!1),window.addEventListener("mousedown",function(e){stopCapture(e)},!1),window.addEventListener("keydown",function(e){Key.onKeydown(e)},!1),window.addEventListener("blur",function(e){paused=!0},!1),window.addEventListener("focus",function(e){paused=!1},!1),loop=(e=>{stats.begin();let o=(new Date).getTime();dt=Math.min(1,(o-last)/1e3),t+=dt,states[state].render(),states[state].step(dt),last=o,l(),stats.end(),requestAnimationFrame(loop)}),world=[0,1,2,3,4,5,6,7,8],rooms=[{draw:function(e){for(h(["0",20,20,1,1,"left","bottom",2,15,0]);i=200,i--;)s(384*Math.random(),256*Math.random(),18)}},{draw:function(e){h(["1",20,20,1,1,"left","bottom",2,15,0])}},{draw:function(e){h(["2",20,20,1,1,"left","bottom",2,15,0])}},{draw:function(e){h(["3",20,20,1,1,"left","bottom",2,15,0])}},{draw:function(e){h(["4",20,20,1,1,"left","bottom",2,15,0])}},{draw:function(e){h(["5",20,20,1,1,"left","bottom",2,15,0])}},{draw:function(e){h(["6",20,20,1,1,"left","bottom",2,15,0]),c(0,205,384,256,25)}},{draw:function(e){h(["7",20,20,1,1,"left","bottom",2,15,0]),u(0,205,384,205,182,136,25),c(0,205,384,256,25)}},{draw:function(e){h(["8",20,20,1,1,"left","bottom",2,15,0]),c(0,205,384,256,25)}}];new x.i(M);player={bullet:{x:0,y:0,xvel:0,yvel:0},init(){this.x=64,this.y=230,this.radius=12,this.xvel=0,this.yvel=0,this.xspeed=400,this.yspeed=400,this.drag=.6},update(e){this.bullet.x=player.x,this.bullet.y=player.y,this.xvel*=player.drag,this.yvel*=player.drag;let t=e*player.xvel,o=e*player.yvel;player.x+=t,player.y+=o,(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.xvel=player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(player.xvel=-player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP))&&(player.yvel=-player.yspeed),(Key.isDown(Key.s)||Key.isDown(Key.DOWN))&&(player.yvel=player.yspeed),Key.isDown(Key.SPACE||Key.isDown(Key.z))&&(player.bullet.yvel=-350,bulletPool.get(player.bullet)),player.x>K&&(player.x=0,v(B)),player.x<0&&(player.x=K,v(U)),player.y>b&&(player.y=0,v(L)),player.y<0&&(player.y=b,v(I))},draw(e){_(this.x,this.y,this.radius,8)}},states.gameover={step:function(e){Key.isDown(Key.r)&&(state="menu")},render:function(e){k=0,a(0),h(["GAME OVER",256,80+15*Math.sin(2.5*t),8+4*Math.cos(2.9*t),15+5*Math.sin(3.5*t),"center","top",9,27])}},states.menu={step:function(e){Key.isDown(Key.p)&&(state="game")},render:function(e){k=0,a(0);let o=t/3;for(let e=-128;e<128;e+=1)for(let t=-256;t<256;t+=2)s(256+t+256*Math.cos(4*(e/128+o))+e,256+e+128*Math.sin(4*(t/256+o))+t,t/8%32);h(["LOSTGAME",K/2,40+15*Math.sin(2.5*t),8+4*Math.cos(2.9*t),15+5*Math.sin(3.5*t),"center","top",6,21]),h(["PRESS P TO CONTINUE",K/2,230,2,2,"center","top",1,21])}},states.game={step(e){player.update(e)},render(e){k=0,a(1),rooms[world[currentRoom[1]*(N+1)+currentRoom[0]]].draw(),player.draw(e),k=0}},Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,a:65,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,isDown(e){return this._pressed[e]},justReleased(e){return this._released[e]},onKeydown(e){this._pressed[e.keyCode]=!0},onKeyup(e){this._released[e.keyCode]=!0,delete this._pressed[e.keyCode]},update(){this._released={}}},window.onload=init()}();
</script></body></html>