<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>JS13K 2017 boilerplate</title><style>
body{margin:0;overflow:hidden;background:#111;color:#ccc}#canvas{position:fixed;top:50%;bottom:0;left:50%;right:0;width:768px;height:512px;transform:translate(-50%,-30%);image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor;cursor:none;margin:auto}
</style></head><body><canvas id="canvas"></canvas><script>
var Stats=function(){function t(t){return n.appendChild(t.dom),t}function e(t){for(var e=0;e<n.children.length;e++)n.children[e].style.display=e===t?"block":"none";o=t}var o=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",function(t){t.preventDefault(),e(++o%n.children.length)},!1);var s=(performance||Date).now(),r=s,a=0,f=t(new Stats.Panel("FPS","#0ff","#002")),i=t(new Stats.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new Stats.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:n,addPanel:t,showPanel:e,begin:function(){s=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(i.update(t-s,200),t>r+1e3&&(f.update(1e3*a/(t-r),100),r=t,a=0,c)){var e=performance.memory;c.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){s=this.end()},domElement:n,setMode:e}};Stats.Panel=function(t,e,o){var n=1/0,s=0,r=Math.round,a=r(window.devicePixelRatio||1),f=80*a,i=48*a,c=3*a,_=2*a,h=3*a,l=15*a,u=74*a,v=30*a,m=document.createElement("canvas");m.width=f,m.height=i,m.style.cssText="width:80px;height:48px";var d=m.getContext("2d");return d.font="bold "+9*a+"px Helvetica,Arial,sans-serif",d.textBaseline="top",d.fillStyle=o,d.l(0,0,f,i),d.fillStyle=e,d.fillText(t,c,_),d.l(h,l,u,v),d.fillStyle=o,d.globalAlpha=.9,d.l(h,l,u,v),{dom:m,update:function(i,x){n=Math.min(n,i),s=Math.max(s,i),d.fillStyle=o,d.globalAlpha=1,d.l(0,0,f,l),d.fillStyle=e,d.fillText(r(i)+" "+t+" ("+r(n)+"-"+r(s)+")",c,_),d.drawImage(m,h+a,l,u-a,v,h,l,u-a,v),d.l(h+u-a,l,a,v),d.fillStyle=o,d.globalAlpha=.9,d.l(h+u-a,l,a,r((1-i/x)*v))}}},"object"==typeof module&&(module.exports=Stats),function(){function e(t){return Math.sin(6.283184*t)}function o(t){return.00390625*Math.pow(1.059463094,t-128)}function n(t,e){setTimeout(function(){var o=new Uint8Array(t*M*2),n=o.length-2,s=function(){for(var t=new Date,r=0;n>=0;)if(o[n]=0,o[n+1]=128,n-=2,(r+=1)%1e3==0&&new Date-t>q)return void setTimeout(s,0);setTimeout(function(){e(o)},0)};setTimeout(s,0)},0)}function s(t,e,o,n,s){var r=o.fx_delay_time*n>>1,a=o.fx_delay_amt/255,f=0,i=function(){for(var o=new Date,n=0;f<e-r;){var c=4*f,_=4*(f+r),h=t[_]+(t[_+1]<<8)+(t[c+2]+(t[c+3]<<8)-32768)*a;if(t[_]=255&h,t[_+1]=h>>8&255,h=t[_+2]+(t[_+3]<<8)+(t[c]+(t[c+1]<<8)-32768)*a,t[_+2]=255&h,t[_+3]=h>>8&255,++f,(n+=1)%1e3==0&&new Date-o>q)return void setTimeout(i,0)}setTimeout(s,0)};setTimeout(i,0)}function r(){P=k,h(1,1,17,17,27),h(2,2,15,15,21),console.log(N[k+T+5])}function a(t){N.fill(t,P,P+131072)}function f(t,e,o){e|=0,o|=0,(t|=0)>0&&t<T&&e>0&&e<D&&(N[P+(e*T+t)]=o)}function i(t,e,o,n,s){var r,a,i=(n|=0)-(e|=0),c=(o|=0)-(t|=0);if(i<0?(i=-i,a=-1):a=1,c<0?(c=-c,r=-1):r=1,i<<=1,c<<=1,f(t,e,s),c>i)for(var _=i-(c>>1);t!=o;)_>=0&&(e+=a,_-=c),_+=i,f(t+=r,e,s);else for(_=c-(i>>1);e!=n;)_>=0&&(t+=r,_-=i),_+=c,f(t,e+=a,s)}function c(t,e,o,n){var s=-o,r=0,a=2-2*o;do{f(t-s,e+r,n),f(t-r,e-s,n),f(t+s,e-r,n),f(t+r,e+s,n),(o=a)<=r&&(a+=2*++r+1),(o>s||a>r)&&(a+=2*++s+1)}while(s<0)}function _(t,e,o,n,s){x1=0|t,y1=0|e,x2=t+o|0,y2=e+n|0,i(x1,y1,x2,y1,s),i(x2,y1,x2,y2,s),i(x1,y2,x2,y2,s),i(x1,y1,x1,y2,s)}function h(t,e,o,n,s){x1=0|t,y1=0|e,x2=t+o|0,y2=e+n|0;var r=Math.abs(y2-y1);if(i(x1,y1,x2,y1,s),r>0)for(;--r;)i(x1,y1+r,x2,y1+r,s);i(x1,y2,x2,y2,s)}function l(t,e,o,n,s,r,a){var f=T,t=Math.round(16*t),o=Math.round(16*o),s=Math.round(16*s),e=Math.round(16*e),i=t-o,c=(n=Math.round(16*n))-e,_=o-s,h=(r=Math.round(16*r))-n,l=s-t,u=e-r,v=Math.max(Math.min(t,o,s)+15>>4,0),m=Math.min(Math.max(t,o,s)+15>>4,T),d=Math.max(Math.min(e,n,r)+15>>4,0),x=Math.min(Math.max(e,n,r)+15>>4,D);v&=-8,d&=-8;var y=-c*t-i*e,p=-h*o-_*n,w=-u*s-l*r;(c>0||0==c&&i>0)&&y++,(h>0||0==h&&_>0)&&p++,(u>0||0==u&&l>0)&&w++,y=y-1>>4,p=p-1>>4,w=w-1>>4;var M=0,q=0,R=0,b=0,K=0,g=0;i>=0?q-=7*i:M-=7*i,c>=0?q-=7*c:M-=7*c,_>=0?b-=7*_:R-=7*_,h>=0?b-=7*h:R-=7*h,l>=0?g-=7*l:K-=7*l,u>=0?g-=7*u:K-=7*u;for(var k=f-8,S=d;S<x;S+=8)for(var A=v;A<m;A+=8){var E=y+i*S+c*A,C=p+_*S+h*A,I=w+l*S+u*A;if(!(E<q||C<b||I<g)){var O=A+S*f;if(E>=M&&C>=R&&I>=K)for(U=0;U<8;U++){for(F=0;F<8;F++,O++)N[P+O]=a;O+=k}else for(var U=0;U<8;U++){for(var X=E,Y=C,B=I,F=0;F<8;F++)(X|Y|B)>=0&&(N[P+O]=a),X+=c,Y+=h,B+=u,O++;E+=i,C+=_,I+=l,O+=k}}}}function u(t=0,e=0,o=16,n=16,s=0,r=0,a=!1,f=!1){for(var i=0;i<n;i++)for(var c=0;c<o;c++)r+i<D&&s+c<T&&r+i>-1&&s+c>-1&&(a&f?N[I+((e+(n-i))*T+t+(o-c))]>0&&(N[P+((r+i)*T+s+c)]=U[N[I+((e+(n-i))*T+t+(o-c))]]):f&&!a?N[I+((e+(n-i))*T+t+c)]>0&&(N[P+((r+i)*T+s+c)]=N[I+((e+(n-i))*T+t+c)]):a&&!f?N[I+((e+i)*T+t+(o-c))]>0&&(N[P+((r+i)*T+s+c)]=N[I+((e+i)*T+t+(o-c))]):a||f||N[I+((e+i)*T+t+c)]>0&&(N[P+((r+i)*T+s+c)]=U[N[I+((e+i)*T+t+c)]]))}function v(){for(var t=g;t--;)F[t]=O[U[N[t]]];X.data.set(B),C.putImageData(X,0,0)}function m(t){switch(P=S,a(0),P=A,a(0),P=0,t){case L:currentRoom[0]--,currentRoom[0]<0&&(currentRoom[0]=j),console.log(currentRoom);break;case G:currentRoom[0]++,currentRoom[0]>j&&(currentRoom[0]=0),console.log(currentRoom);break;case H:currentRoom[1]--,currentRoom[1]<0&&(currentRoom[1]=z),console.log(currentRoom);break;case V:currentRoom[1]++,currentRoom[1]>z&&(currentRoom[1]=0),console.log(currentRoom)}}function d(t){for(var e=t[0].length,o=0;o<e;o++){var n=[];n=y(t[0].charAt(o));for(var s=0;s<5;s++)for(var r=0;r<5;r++)1==n[5*s+r]&&(1==t[4]?f(t[1]+r*t[4]+(5*t[4]+t[3])*o,t[2]+s*t[4],t[5]):h(t[1]+r*t[4]+(5*t[4]+t[3])*o,t[2]+s*t[4],t[4],t[4],t[5]))}}function x(t){var e=5*t[7],o=t[0].split("\n"),n=o.slice(0),s=o.length,r=n.sort(function(t,e){return e.length-t.length})[0],a=r.length*e+(r.length-1)*t[3],f=s*e+(s-1)*t[4];t[5]||(t[5]="left"),t[6]||(t[6]="bottom");var i=t[1],c=t[2],_=t[1]+a,h=t[2]+f;"center"==t[5]?(i=t[1]-a/2,_=t[1]+a/2):"right"==t[5]&&(i=t[1]-a,_=t[1]),"center"==t[6]?(c=t[2]-f/2,h=t[2]+f/2):"bottom"==t[6]&&(c=t[2]-f,h=t[2]);for(var l=i+a/2,u=c+f/2,v=0;v<s;v++){var m=o[v],x=m.length*e+(m.length-1)*t[3],y=t[1],p=t[2]+(e+t[4])*v;"center"==t[5]?y=t[1]-x/2:"right"==t[5]&&(y=t[1]-x),"center"==t[6]?p-=f/2:"bottom"==t[6]&&(p-=f),d([m,y,p,t[3]||0,t[7]||1,t[8],t[9]])}return{sx:i,sy:c,cx:l,cy:u,ex:_,ey:h,width:a,height:f}}function y(t){return index=fontString.indexOf(t),fontBitmap.substring(25*index,25*index+25).split("")}var p={seed:Date.now(),a:1664525,c:1013904223,m:Math.pow(2,32),setSeed:function(t){this.seed=t},nextInt:function(){return this.seed=(this.seed*this.a+this.c)%this.m,this.seed},nextFloat:function(){return this.nextInt()/this.m},nextBool:function(t){return null==t&&(t=.5),this.nextFloat()<t},nextFloatRange:function(t,e){return t+this.nextFloat()*(e-t)},nextIntRange:function(t,e){return Math.floor(this.nextFloatRange(t,e))},nextColor:function(){for(var t=this.nextIntRange(0,Math.pow(2,24)).toString(16).toUpperCase();t.length<6;)t="0"+t;return"#"+t}},w={},M=2,q=33,R=null,b=[e,function(t){return e(t)<0?-1:1},function(t){return t%1-.5},function(t){var e=t%1*4;return e<2?e-1:3-e}];w.AudioGenerator=function(t){this.mixBuf=t,this.waveSize=t.length/M/2},w.AudioGenerator.prototype.getAudioBuffer=function(t){null===R&&(R=new AudioContext);var e=this.mixBuf,o=this.waveSize*M*2,n=R.createBuffer(M,this.waveSize,44100),s=n.getChannelData(0),r=n.getChannelData(1),a=0,f=function(){for(var i=new Date,c=0;a<o/2;){var _=4*(e[4*a]+(e[4*a+1]<<8)-32768);if(_=_<-32768?-32768:_>32767?32767:_,s[a]=_/32768,_=4*(e[4*a+2]+(e[4*a+3]<<8)-32768),_=_<-32768?-32768:_>32767?32767:_,r[a]=_/32768,a+=1,(c+=1)%1e3==0&&new Date-i>q)return void setTimeout(f,0)}setTimeout(function(){t(n)},0)};setTimeout(f,0)},w.SoundGenerator=function(t,e){this.instr=t,this.rowLen=e||5605,this.osc_lfo=b[t.lfo_waveform],this.osc1=b[t.osc1_waveform],this.osc2=b[t.osc2_waveform],this.attack=t.env_attack,this.sustain=t.env_sustain,this.release=t.env_release,this.panFreq=Math.pow(2,t.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,t.lfo_freq-8)/this.rowLen},w.SoundGenerator.prototype.genSound=function(t,n,s){new Date;for(var r=0,a=0,f=o(t+12*(this.instr.e-8)+this.instr.t)*(1+8e-4*this.instr.o),i=o(t+12*(this.instr.osc2_oct-8)+this.instr.osc2_det)*(1+8e-4*this.instr.osc2_detune),c=this.instr.fx_resonance/255,_=0,h=0,l=this.attack+this.sustain+this.release-1;l>=0;--l){var u=l+s,v=this.osc_lfo(u*this.lfoFreq)*this.instr.lfo_amt/512+.5,m=1;l<this.attack?m=l/this.attack:l>=this.attack+this.sustain&&(m-=(l-this.attack-this.sustain)/this.release);var d=f;this.instr.lfo_osc1_freq&&(d+=v),this.instr.osc1_xenv&&(d*=m*m),r+=d;var x=this.osc1(r)*this.instr.osc1_vol;d=i,this.instr.osc2_xenv&&(d*=m*m),a+=d,x+=this.osc2(a)*this.instr.osc2_vol,this.instr.noise_fader&&(x+=(2*Math.random()-1)*this.instr.noise_fader*m),x*=m/255;var y=this.instr.fx_freq;this.instr.lfo_fx_freq&&(y*=v);var p=c*(x-h)-(_+=(y=1.5*Math.sin(3.141592*y/44100))*h);switch(h+=y*p,this.instr.fx_filter){case 1:x=p;break;case 2:x=_;break;case 3:x=h;break;case 4:x=_+p}if(d=e(u*this.panFreq)*this.instr.fx_pan_amt/512+.5,x*=39*this.instr.env_master,(u*=4)+3<n.length){var w=n[u]+(n[u+1]<<8)+x*(1-d);n[u]=255&w,n[u+1]=w>>8&255,w=n[u+2]+(n[u+3]<<8)+x*d,n[u+2]=255&w,n[u+3]=w>>8&255}}},w.SoundGenerator.prototype._=function(t,e){var o=this.attack+this.sustain+this.release-1+32*this.rowLen,r=this;n(o,function(n){r.genSound(t,n,0),s(n,o,r.instr,r.rowLen,function(){e(new w.AudioGenerator(n))})})},w.SoundGenerator.prototype.createAudioBuffer=function(t,e){this._(t,function(t){t.getAudioBuffer(e)})},w.i=function(t){this.song=t,this.waveSize=44100*t.songLen},w.i.prototype.generateTrack=function(t,e,o){var r=this;n(this.waveSize,function(n){var a=r.waveSize,f=r.waveSize*M*2,i=r.song.rowLen,c=r.song.endPattern,_=new w.SoundGenerator(t,i),h=0,l=0,u=0,v=function(){for(var e=new Date;;)if(32!==u){if(l===c-1)return void setTimeout(m,0);var o=t.p[l];if(o){var s=t.c[o-1].n[u];s&&_.genSound(s,n,h)}if(h+=i,u+=1,new Date-e>q)return void setTimeout(v,0)}else u=0,l+=1},m=function(){s(n,a,t,i,x)},d=0,x=function(){for(var t=new Date,s=0;d<f;){var r=e[d]+(e[d+1]<<8)+n[d]+(n[d+1]<<8)-32768;if(e[d]=255&r,e[d+1]=r>>8&255,d+=2,(s+=1)%1e3==0&&new Date-t>q)return void setTimeout(x,0)}setTimeout(o,0)};setTimeout(v,0)})},w.i.prototype._=function(t){var e=this;n(this.waveSize,function(o){var n=0,s=function(){n<e.song.songData.length?(n+=1,e.generateTrack(e.song.songData[n-1],o,s)):t(new w.AudioGenerator(o))};s()})},w.i.prototype.createAudioBuffer=function(t){this._(function(e){e.getAudioBuffer(t)})};var K={songLen:37,songData:[{e:7,t:0,o:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:3,osc2_oct:7,osc2_det:0,osc2_detune:7,osc2_xenv:0,osc2_vol:201,osc2_waveform:3,noise_fader:0,env_attack:789,env_sustain:1234,env_release:13636,env_master:191,fx_filter:2,fx_freq:5839,fx_resonance:254,fx_delay_time:6,fx_delay_amt:121,fx_pan_freq:6,fx_pan_amt:147,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:6,lfo_amt:195,lfo_waveform:0,p:[1,2,0,0,1,2,1,2],c:[{n:[154,0,154,0,152,0,147,0,0,0,0,0,0,0,0,0,154,0,154,0,152,0,157,0,0,0,156,0,0,0,0,0]},{n:[154,0,154,0,152,0,147,0,0,0,0,0,0,0,0,0,154,0,154,0,152,0,157,0,0,0,159,0,0,0,0,0]}]},{e:7,t:0,o:0,osc1_xenv:0,osc1_vol:255,osc1_waveform:2,osc2_oct:8,osc2_det:0,osc2_detune:18,osc2_xenv:1,osc2_vol:191,osc2_waveform:2,noise_fader:0,env_attack:3997,env_sustain:56363,env_release:1e5,env_master:255,fx_filter:2,fx_freq:392,fx_resonance:255,fx_delay_time:8,fx_delay_amt:69,fx_pan_freq:5,fx_pan_amt:67,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:4,lfo_amt:57,lfo_waveform:3,p:[1,2,1,2,1,2,1,2],c:[{n:[130,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{n:[123,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]},{e:8,t:0,o:0,osc1_xenv:0,osc1_vol:0,osc1_waveform:0,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:60,env_attack:50,env_sustain:419,env_release:4607,env_master:130,fx_filter:1,fx_freq:10332,fx_resonance:120,fx_delay_time:4,fx_delay_amt:16,fx_pan_freq:5,fx_pan_amt:108,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:5,lfo_amt:187,lfo_waveform:0,p:[0,0,0,0,1,1],c:[{n:[0,0,147,0,0,0,147,147,0,0,147,0,0,147,0,147,0,0,147,0,0,0,147,147,0,0,147,0,0,147,0,147]}]},{e:7,t:0,o:0,osc1_xenv:1,osc1_vol:255,osc1_waveform:0,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:255,osc2_waveform:0,noise_fader:0,env_attack:50,env_sustain:150,env_release:4800,env_master:200,fx_filter:2,fx_freq:600,fx_resonance:254,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1,1,1,1,1,1],c:[{n:[147,0,0,0,0,0,0,0,147,0,0,0,0,0,0,0,147,0,0,0,0,0,0,0,147,0,0,0,0,0,0,0]}]},{e:7,t:0,o:0,osc1_xenv:0,osc1_vol:255,osc1_waveform:2,osc2_oct:7,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:154,osc2_waveform:2,noise_fader:0,env_attack:2418,env_sustain:1075,env_release:10614,env_master:240,fx_filter:3,fx_freq:2962,fx_resonance:255,fx_delay_time:6,fx_delay_amt:117,fx_pan_freq:3,fx_pan_amt:73,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:5,lfo_amt:124,lfo_waveform:0,p:[0,0,0,0,1,2,1,2],c:[{n:[154,0,154,0,152,0,147,0,0,0,0,0,0,0,0,0,154,0,154,0,152,0,157,0,0,0,156,0,0,0,0,0]},{n:[154,0,154,0,152,0,147,0,0,0,0,0,0,0,0,0,154,0,147,0,152,0,157,0,0,0,159,0,0,0,0,0]}]},{e:7,t:0,o:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:1,osc2_oct:6,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:137,env_sustain:2e3,env_release:4611,env_master:192,fx_filter:1,fx_freq:982,fx_resonance:89,fx_delay_time:6,fx_delay_amt:25,fx_pan_freq:6,fx_pan_amt:77,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:69,lfo_waveform:0,p:[1,2,1,3,1,3],c:[{n:[130,0,130,0,142,0,130,130,0,142,130,0,142,0,130,0,130,0,130,0,142,0,130,130,0,142,130,0,142,0,130,0]},{n:[123,0,123,0,135,0,123,123,0,135,123,0,135,0,123,0,123,0,123,0,135,0,123,123,0,135,123,0,135,0,123,0]},{n:[135,0,135,0,147,0,135,135,0,147,135,0,147,0,135,0,135,0,135,0,147,0,135,135,0,147,135,0,147,0,135,0]}]},{e:7,t:0,o:0,osc1_xenv:0,osc1_vol:255,osc1_waveform:3,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:255,osc2_waveform:0,noise_fader:127,env_attack:22,env_sustain:88,env_release:3997,env_master:255,fx_filter:3,fx_freq:4067,fx_resonance:234,fx_delay_time:4,fx_delay_amt:33,fx_pan_freq:2,fx_pan_amt:84,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:28,lfo_waveform:0,p:[0,0,1,2,1,2,1,3],c:[{n:[0,0,142,0,154,0,0,0,142,0,0,0,154,0,0,0,0,0,142,0,154,0,0,0,142,0,0,0,154,0,0,0]},{n:[0,0,147,0,154,0,0,0,147,0,0,0,154,0,0,0,0,0,147,0,154,0,147,0,0,0,154,0,0,0,154,0]},{n:[0,0,147,0,154,0,0,0,147,0,0,0,154,0,0,0,0,0,147,0,154,0,0,0,147,0,0,0,0,0,0,0]}]},{e:8,t:0,o:0,osc1_xenv:0,osc1_vol:0,osc1_waveform:0,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:255,env_attack:140347,env_sustain:9216,env_release:133417,env_master:208,fx_filter:2,fx_freq:2500,fx_resonance:16,fx_delay_time:2,fx_delay_amt:157,fx_pan_freq:8,fx_pan_amt:207,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:2,lfo_amt:51,lfo_waveform:0,p:[0,0,1,1,1,1,1,1],c:[{n:[147,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],rowLen:5513,endPattern:9};fontString="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_!@.'\"?/<()",fontBitmap="11111100011111110001100011111010001111101000111110111111000010000100000111111100100101000110001111101111110000111001000011111111111000011100100001000011111100001011110001111111000110001111111000110001111110010000100001001111111111000100001010010111101000110010111001001010001100001000010000100001111110001110111010110001100011000111001101011001110001011101000110001100010111011110100011001011100100000111010001100011001001111111101000111110100011000101111100000111000001111101111100100001000010000100100011000110001100010111010001100011000101010001001000110001101011010101110100010101000100010101000110001010100010000100001001111100010001000100011111001000110000100001000111001110100010001000100111111111000001001100000111110100101001011111000100001011111100001111000001111100111110000111101000101110111110000100010001000010001110100010111010001011100111010001011110000101110011101000110001100010111000000000000000000000111110010000100001000000000100111111000110111101011011101010111110101011111010100000000000000000000000100001100001000100000000000011011010011001000000000000111010001001100000000100000010001000100010001000000010001000100000100000100001000100001000010000010";const T=384,D=256,g=T*D|0,k=4*g|0,S=6*g|0,A=5*g|0;var E=document.getElementById("canvas"),C=E.getContext("2d"),P=0,I=g,O=[4278190080,4281606178,4282132549,4281416038,4282078863,4280709599,4284915929,4288332782,4281791227,4283491737,4281384554,4285436983,4281297227,4280568658,4281941042,4285808447,4286734384,4292963931,4294941539,4293184863,4294761419,4294967295,4290227611,4287069828,4285164137,4283586137,4287251062,4281479852,4284700633,4290411479,4283078543,4281364362],U=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31];C.imageSmoothingEnabled=!1,C.mozImageSmoothingEnabled=!1,E.width=T,E.height=D;var X=C.getImageData(0,0,T,D),Y=new ArrayBuffer(X.data.length),B=new Uint8Array(Y),F=new Uint32Array(Y),N=new Uint8ClampedArray(T*D*10);Number.prototype.clamp=function(t,e){return Math.min(Math.max(this,t),e)};const L=1,G=2,H=3,V=4,j=2,z=2;states={},init=(()=>{r(),last=0,dt=0,now=0,t=0,songTrigger=!1,state="game",R=new AudioContext,currentRoom=[0,0],player.init(),stats=new Stats,document.body.appendChild(stats.dom),loop()}),stopCapture=(t=>{}),window.addEventListener("keyup",function(t){Key.onKeyup(t)},!1),window.addEventListener("mousedown",function(t){stopCapture(t)},!1),window.addEventListener("keydown",function(t){Key.onKeydown(t)},!1),window.addEventListener("blur",function(t){paused=!0},!1),window.addEventListener("focus",function(t){paused=!1},!1),loop=(e=>{stats.begin();let o=(new Date).getTime();dt=Math.min(1,(o-last)/1e3),t+=dt,states[state].render(),states[state].step(dt),last=o,v(),stats.end(),requestAnimationFrame(loop)}),world=[7,0,0,0,0,0,6,7,8],rooms=[{draw:function(t){I=k,P=0,u(0,0,T,D),x(["0",20,20,1,1,"left","bottom",2,15,0]),p.setSeed(1019);for(let t=0;t<200;t++)f(p.nextIntRange(0,384),p.nextIntRange(0,256),16)}},{draw:function(e){x(["1",20,20,1,1,"left","bottom",2,15,0]);for(let e=0;e<384;e+=40)for(let o=0;o<256;o+=40){let n=e-192+40*Math.sin(t),s=o-128+40*Math.cos(t);c(e,o,Math.sqrt(n*n+s*s)-8,14)}}},{draw:function(e){I=k,P=0,u(0,0,T,D),x(["2",20,20,1,1,"left","bottom",2,15,0]);for(let e=0;e<384;e+=40)for(let o=0;o<256;o+=40){let n=e-576+40*Math.sin(t),s=o-128+40*Math.cos(t);c(e,o,Math.sqrt(n*n+s*s)-8,14)}}},{draw:function(t){P=S,h(0,0,127,256,27),h(250,0,127,256,27),P=0,x(["3",20,20,1,1,"left","bottom",2,15,0])}},{draw:function(t){P=S,h(0,0,127,256,27),h(250,0,127,256,27),P=0,x(["4",20,20,1,1,"left","bottom",2,15,0])}},{draw:function(t){x(["5",20,20,1,1,"left","bottom",2,15,0])}},{draw:function(t){x(["6",20,20,1,1,"left","bottom",2,15,0]),P=S,h(0,205,384,10,25),P=0}},{draw:function(t){x(["7",20,20,1,1,"left","bottom",2,15,0]),P=S,l(0,256,384,256,182,205,25),h(100,90,10,80,24),h(100,160,100,10,23),h(200,900,10,100,23),h(210,90,100,100,22),P=0}},{draw:function(t){x(["8",20,20,1,1,"left","bottom",2,15,0]),P=S,h(0,205,384,10,25),P=0}}];new w.i(K);player={bullet:{x:0,y:0,xvel:0,yvel:0},init(){this.x=64,this.y=64,this.radius=9,this.xvel=0,this.yvel=0,this.xspeed=200,this.yspeed=200,this.drag=.8,this.gravity=7,this.maxYvel=400,this.maxXvel=400,this.minYvel=-400,this.minXvel=-400},update(t){this.bullet.x=player.x,this.bullet.y=player.y,this.xvel*=player.drag,this.yvel+=player.gravity,this.yvel=this.yvel.clamp(this.minYvel,this.maxYvel),this.xvel=this.xvel.clamp(this.minXvel,this.maxXvel);let e=t*player.xvel,o=t*player.yvel;player.x+=e,player.y+=o,this.b={u:this.x-this.radius|0,h:this.x+this.radius|0,v:this.y-this.radius|0,M:this.y+this.radius|0,width:2*this.radius,height:2*this.radius},(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.xvel=player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(player.xvel=-player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP))&&(player.yvel=-player.yspeed),(Key.isDown(Key.s)||Key.isDown(Key.DOWN))&&(player.yvel=player.yspeed),offsetX=this.collideResolutionX(t),offsetY=this.collideResolutionY(t),Math.abs(offsetX)<Math.abs(offsetY)&&(this.collides(this.x+offsetX,this.y)||(this.x+=offsetX)),Math.abs(offsetY)<Math.abs(offsetX)&&(this.collides(this.x,this.y+offsetY)||(this.y+=offsetY)),player.x>T&&(player.x=0,m(G)),player.x<0&&(player.x=T,m(L)),player.y>D&&(player.y=0,m(V)),player.y<0&&(player.y=D,m(H))},draw(t){I=k,P=0,u(1,1,18,18,this.x-this.radius|0,this.y-this.radius|0),_(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},collides:(t,e)=>N[S+t+e*T],collideResolutionY(t){let e=0,o=this.b;for(let t=o.u;t<=o.h;t++)if(N[S+t+T*o.M])for(let n=o.M;n>=o.v;n--)N[S+t+T*n]&&(e=n-o.M);for(let t=o.u;t<=o.h;t++)if(N[S+t+T*o.v])for(let n=o.v;n<=o.M;n++)N[S+t+T*n]&&(e=n-o.v);return e},collideResolutionX(t){let e=0,o=this.b;for(let t=o.v+4;t<=o.M-4;t++)if(N[S+o.u+T*t])for(let n=o.u;n<=o.h;n++)N[S+n+T*t]&&(e=n-o.u);for(let t=o.v+4;t<=o.M-4;t++)if(N[S+o.h+T*t])for(let n=o.h;n>=o.u;n--)N[S+n+T*t]&&(e=n-o.h);return e}},states.gameover={step:function(t){Key.isDown(Key.r)&&(state="menu")},render:function(e){P=0,a(0),x(["GAME OVER",256,80+15*Math.sin(2.5*t),8+4*Math.cos(2.9*t),15+5*Math.sin(3.5*t),"center","top",9,27])}},states.menu={step:function(t){Key.isDown(Key.p)&&(state="game")},render:function(e){P=0,a(0);let o=t/3;for(let t=-128;t<128;t+=1)for(let e=-256;e<256;e+=2)f(256+e+256*Math.cos(4*(t/128+o))+t,256+t+128*Math.sin(4*(e/256+o))+e,e/8%32);x(["LOSTGAME",T/2,40+15*Math.sin(2.5*t),8+4*Math.cos(2.9*t),15+5*Math.sin(3.5*t),"center","top",6,21]),x(["PRESS P TO CONTINUE",T/2,230,2,2,"center","top",1,21])}},states.game={step(t){player.update(t)},render(t){P=0,a(1),P=S,a(0),P=0,rooms[world[currentRoom[1]*(j+1)+currentRoom[0]]].draw(),I=S,u(0,0,T,D),I=A,u(0,0,T,D),player.draw(t),P=0}},Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,a:65,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,isDown(t){return this._pressed[t]},justReleased(t){return this._released[t]},onKeydown(t){this._pressed[t.keyCode]=!0},onKeyup(t){this._released[t.keyCode]=!0,delete this._pressed[t.keyCode]},update(){this._released={}}},window.onload=init()}();
</script></body></html>